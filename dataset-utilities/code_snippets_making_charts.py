"""This script contains some code snippets for creating charts out of meassured data.

File is divided by "# %%" marker, which was also used
    for vscode inside execution with jupyter functions.

Author: Vojtěch Vlach
Contact: xvlach22@vutbr.cz
"""


import numpy as np
import re
import os
import sys

import matplotlib.pyplot as plt

sys.path.append(os.path.join('..', 'dataset-utilities'))
from common import Common  # noqa: E402



# %% Seaparate MONO SER from evaluate_checkpoints json

results = {
    'sagnostic CRNN-CTC': {"0": {"_0": {"wer": 100.0, "cer": 99.9586, "pitch_ser": 100.0, "rhythm_ser": 100.0, "seqer": 100.0}}, "2000": {"_0": {"wer": 19.9964, "cer": 7.9613, "pitch_ser": 18.653, "rhythm_ser": 15.5532, "seqer": 72.45}}, "4000": {"_0": {"wer": 14.15, "cer": 5.5891, "pitch_ser": 14.03, "rhythm_ser": 10.3544, "seqer": 52.0}}, "6000": {"_0": {"wer": 12.3421, "cer": 5.4676, "pitch_ser": 11.8261, "rhythm_ser": 9.2553, "seqer": 45.6}}, "8000": {"_0": {"wer": 12.6803, "cer": 5.9222, "pitch_ser": 12.7273, "rhythm_ser": 9.7104, "seqer": 43.3}}, "10000": {"_0": {"wer": 9.6906, "cer": 4.2194, "pitch_ser": 9.1636, "rhythm_ser": 7.0426, "seqer": 38.5}}, "12000": {"_0": {"wer": 8.8361, "cer": 3.9094, "pitch_ser": 8.196, "rhythm_ser": 6.5983, "seqer": 34.3}}, "14000": {"_0": {"wer": 10.259, "cer": 4.8792, "pitch_ser": 9.834, "rhythm_ser": 7.7802, "seqer": 35.8}}, "16000": {"_0": {"wer": 8.7228, "cer": 3.8255, "pitch_ser": 8.253, "rhythm_ser": 6.3932, "seqer": 34.3}}, "18000": {"_0": {"wer": 7.5859, "cer": 3.3662, "pitch_ser": 7.0103, "rhythm_ser": 5.7978, "seqer": 29.6}}, "20000": {"_0": {"wer": 7.3736, "cer": 3.3514, "pitch_ser": 6.8174, "rhythm_ser": 5.5136, "seqer": 29.3}}, "22000": {"_0": {"wer": 6.8627, "cer": 3.0415, "pitch_ser": 6.2261, "rhythm_ser": 5.1196, "seqer": 26.45}}, "24000": {"_0": {"wer": 7.2639, "cer": 3.0065, "pitch_ser": 6.5834, "rhythm_ser": 5.3877, "seqer": 29.35}}, "26000": {"_0": {"wer": 7.4042, "cer": 3.1239, "pitch_ser": 6.83, "rhythm_ser": 5.4146, "seqer": 30.1}}, "28000": {"_0": {"wer": 7.9187, "cer": 3.4889, "pitch_ser": 7.3644, "rhythm_ser": 5.9489, "seqer": 29.4}}, "30000": {"_0": {"wer": 7.0768, "cer": 3.3655, "pitch_ser": 6.6182, "rhythm_ser": 5.4848, "seqer": 27.7}}, "32000": {"_0": {"wer": 7.2963, "cer": 3.7768, "pitch_ser": 6.7099, "rhythm_ser": 5.5172, "seqer": 28.9}}, "34000": {"_0": {"wer": 6.8987, "cer": 3.3339, "pitch_ser": 6.5866, "rhythm_ser": 5.2042, "seqer": 28.4}}, "36000": {"_0": {"wer": 5.7726, "cer": 2.6783, "pitch_ser": 5.2996, "rhythm_ser": 4.231, "seqer": 25.75}}, "38000": {"_0": {"wer": 6.3267, "cer": 2.7307, "pitch_ser": 5.8972, "rhythm_ser": 4.5188, "seqer": 26.55}}, "40000": {"_0": {"wer": 6.1684, "cer": 2.7987, "pitch_ser": 5.7138, "rhythm_ser": 4.5872, "seqer": 25.2}}, "42000": {"_0": {"wer": 6.2943, "cer": 2.82, "pitch_ser": 5.7739, "rhythm_ser": 4.6573, "seqer": 25.2}}, "44000": {"_0": {"wer": 6.3159, "cer": 2.8899, "pitch_ser": 5.7296, "rhythm_ser": 4.6609, "seqer": 25.6}}, "46000": {"_0": {"wer": 5.7312, "cer": 2.7292, "pitch_ser": 5.2395, "rhythm_ser": 4.3857, "seqer": 25.3}}, "48000": {"_0": {"wer": 6.1972, "cer": 2.8512, "pitch_ser": 5.7296, "rhythm_ser": 4.445, "seqer": 25.15}}, "50000": {"_0": {"wer": 7.343, "cer": 3.2056, "pitch_ser": 6.3968, "rhythm_ser": 5.6935, "seqer": 34.2}}, "52000": {"_0": {"wer": 6.5839, "cer": 2.9427, "pitch_ser": 6.1755, "rhythm_ser": 4.8228, "seqer": 28.4}}, "54000": {"_0": {"wer": 22.5472, "cer": 9.2516, "pitch_ser": 23.4435, "rhythm_ser": 14.8534, "seqer": 87.4}}, "56000": {"_0": {"wer": 5.7007, "cer": 2.5458, "pitch_ser": 5.0972, "rhythm_ser": 4.0439, "seqer": 24.55}}, "58000": {"_0": {"wer": 5.0225, "cer": 2.3573, "pitch_ser": 4.4648, "rhythm_ser": 3.5978, "seqer": 22.85}}, "60000": {"_0": {"wer": 4.848, "cer": 2.2506, "pitch_ser": 4.2593, "rhythm_ser": 3.4485, "seqer": 22.05}}, "62000": {"_0": {"wer": 4.454, "cer": 2.1564, "pitch_ser": 3.9115, "rhythm_ser": 3.2434, "seqer": 20.9}}, "64000": {"_0": {"wer": 4.5278, "cer": 2.2073, "pitch_ser": 3.9779, "rhythm_ser": 3.3028, "seqer": 21.85}}, "66000": {"_0": {"wer": 4.2328, "cer": 2.0284, "pitch_ser": 3.6806, "rhythm_ser": 3.0419, "seqer": 20.95}}, "68000": {"_0": {"wer": 3.9378, "cer": 1.7484, "pitch_ser": 3.4119, "rhythm_ser": 2.7613, "seqer": 20.75}}, "70000": {"_0": {"wer": 3.8892, "cer": 1.8354, "pitch_ser": 3.4024, "rhythm_ser": 2.7703, "seqer": 19.7}}, "72000": {"_0": {"wer": 3.918, "cer": 1.7918, "pitch_ser": 3.3486, "rhythm_ser": 2.7865, "seqer": 19.65}}, "74000": {"_0": {"wer": 4.0025, "cer": 1.9528, "pitch_ser": 3.4909, "rhythm_ser": 2.8332, "seqer": 20.15}}, "76000": {"_0": {"wer": 3.9917, "cer": 1.7701, "pitch_ser": 3.5036, "rhythm_ser": 2.7919, "seqer": 20.5}}, "78000": {"_0": {"wer": 3.855, "cer": 1.8225, "pitch_ser": 3.3676, "rhythm_ser": 2.7127, "seqer": 19.65}}, "80000": {"_0": {"wer": 3.8352, "cer": 1.7861, "pitch_ser": 3.3644, "rhythm_ser": 2.639, "seqer": 19.95}}, "82000": {"_0": {"wer": 3.9989, "cer": 1.9365, "pitch_ser": 3.5225, "rhythm_ser": 2.8225, "seqer": 20.7}}, "84000": {"_0": {"wer": 3.7759, "cer": 1.8161, "pitch_ser": 3.2443, "rhythm_ser": 2.6408, "seqer": 19.3}}, "86000": {"_0": {"wer": 3.7489, "cer": 1.7728, "pitch_ser": 3.3423, "rhythm_ser": 2.5796, "seqer": 19.05}}, "88000": {"_0": {"wer": 3.6679, "cer": 1.6911, "pitch_ser": 3.2126, "rhythm_ser": 2.5526, "seqer": 19.75}}, "90000": {"_0": {"wer": 3.7129, "cer": 1.7587, "pitch_ser": 3.2411, "rhythm_ser": 2.6246, "seqer": 19.8}}, "92000": {"_0": {"wer": 3.7597, "cer": 1.7253, "pitch_ser": 3.2854, "rhythm_ser": 2.6102, "seqer": 20.0}}, "94000": {"_0": {"wer": 3.7956, "cer": 1.7188, "pitch_ser": 3.2885, "rhythm_ser": 2.6641, "seqer": 19.45}}, "96000": {"_0": {"wer": 3.9432, "cer": 1.7249, "pitch_ser": 3.4119, "rhythm_ser": 2.7235, "seqer": 20.1}}, "98000": {"_0": {"wer": 4.1338, "cer": 1.9855, "pitch_ser": 3.532, "rhythm_ser": 2.9412, "seqer": 20.6}}, "100000": {"_0": {"wer": 3.9791, "cer": 1.935, "pitch_ser": 3.396, "rhythm_ser": 2.8566, "seqer": 20.1}}, "102000": {"_0": {"wer": 3.8586, "cer": 1.8856, "pitch_ser": 3.4372, "rhythm_ser": 2.6785, "seqer": 19.75}}, "104000": {"_0": {"wer": 3.5924, "cer": 1.7154, "pitch_ser": 3.2348, "rhythm_ser": 2.4411, "seqer": 18.95}}, "106000": {"_0": {"wer": 3.7992, "cer": 1.7386, "pitch_ser": 3.298, "rhythm_ser": 2.585, "seqer": 19.4}}, "108000": {"_0": {"wer": 3.6355, "cer": 1.6808, "pitch_ser": 3.1304, "rhythm_ser": 2.5994, "seqer": 18.9}}, "110000": {"_0": {"wer": 4.0673, "cer": 1.8111, "pitch_ser": 3.513, "rhythm_ser": 2.898, "seqer": 19.8}}, "112000": {"_0": {"wer": 3.7507, "cer": 1.8229, "pitch_ser": 3.3075, "rhythm_ser": 2.6102, "seqer": 19.3}}, "114000": {"_0": {"wer": 3.7435, "cer": 1.7154, "pitch_ser": 3.1747, "rhythm_ser": 2.6875, "seqer": 18.95}}, "116000": {"_0": {"wer": 3.7813, "cer": 1.9148, "pitch_ser": 3.396, "rhythm_ser": 2.6444, "seqer": 19.3}}, "118000": {"_0": {"wer": 3.4413, "cer": 1.5354, "pitch_ser": 2.8964, "rhythm_ser": 2.3547, "seqer": 18.55}}, "120000": {"_0": {"wer": 3.5204, "cer": 1.5718, "pitch_ser": 3.1051, "rhythm_ser": 2.5868, "seqer": 18.8}}},
    'ssemantic CRNN-CTC': {"0": {"_0": {"wer": 100.0, "cer": 99.7629, "pitch_ser": 100.0, "rhythm_ser": 100.0, "seqer": 100.0}}, "2000": {"_0": {"wer": 29.8591, "cer": 9.026, "pitch_ser": 35.9576, "rhythm_ser": 12.98, "seqer": 93.3}}, "4000": {"_0": {"wer": 11.6196, "cer": 3.4307, "pitch_ser": 14.4622, "rhythm_ser": 4.7142, "seqer": 62.45}}, "6000": {"_0": {"wer": 7.7144, "cer": 2.3039, "pitch_ser": 8.9455, "rhythm_ser": 3.4732, "seqer": 47.1}}, "8000": {"_0": {"wer": 6.2779, "cer": 1.9769, "pitch_ser": 6.6341, "rhythm_ser": 3.257, "seqer": 39.15}}, "10000": {"_0": {"wer": 5.8817, "cer": 2.0092, "pitch_ser": 6.5256, "rhythm_ser": 3.3419, "seqer": 32.0}}, "12000": {"_0": {"wer": 5.1332, "cer": 1.6213, "pitch_ser": 5.5263, "rhythm_ser": 2.6021, "seqer": 28.7}}, "14000": {"_0": {"wer": 4.3159, "cer": 1.3164, "pitch_ser": 4.7697, "rhythm_ser": 2.1073, "seqer": 27.8}}, "16000": {"_0": {"wer": 3.6591, "cer": 1.1665, "pitch_ser": 3.5693, "rhythm_ser": 2.0176, "seqer": 23.1}}, "18000": {"_0": {"wer": 3.6967, "cer": 1.2444, "pitch_ser": 4.0545, "rhythm_ser": 2.0512, "seqer": 22.55}}, "20000": {"_0": {"wer": 3.5195, "cer": 1.1822, "pitch_ser": 3.7449, "rhythm_ser": 2.0881, "seqer": 19.95}}, "22000": {"_0": {"wer": 3.5195, "cer": 1.0784, "pitch_ser": 3.499, "rhythm_ser": 2.2834, "seqer": 21.2}}, "24000": {"_0": {"wer": 3.6383, "cer": 1.3473, "pitch_ser": 3.7672, "rhythm_ser": 2.245, "seqer": 19.95}}, "26000": {"_0": {"wer": 3.0482, "cer": 1.0821, "pitch_ser": 3.0776, "rhythm_ser": 1.7438, "seqer": 17.05}}, "28000": {"_0": {"wer": 2.6646, "cer": 0.8976, "pitch_ser": 2.4902, "rhythm_ser": 1.6365, "seqer": 16.9}}, "30000": {"_0": {"wer": 2.8794, "cer": 1.0816, "pitch_ser": 2.9435, "rhythm_ser": 1.6445, "seqer": 14.35}}, "32000": {"_0": {"wer": 2.7647, "cer": 1.0595, "pitch_ser": 2.8733, "rhythm_ser": 1.4876, "seqer": 13.9}}, "34000": {"_0": {"wer": 2.4186, "cer": 0.7915, "pitch_ser": 2.305, "rhythm_ser": 1.3291, "seqer": 15.4}}, "36000": {"_0": {"wer": 2.404, "cer": 0.8335, "pitch_ser": 2.3753, "rhythm_ser": 1.2794, "seqer": 13.25}}, "38000": {"_0": {"wer": 2.9628, "cer": 1.1388, "pitch_ser": 2.9308, "rhythm_ser": 1.8815, "seqer": 15.2}}, "40000": {"_0": {"wer": 2.5812, "cer": 1.0064, "pitch_ser": 2.669, "rhythm_ser": 1.4956, "seqer": 13.25}}, "42000": {"_0": {"wer": 2.4895, "cer": 0.9146, "pitch_ser": 2.4327, "rhythm_ser": 1.3147, "seqer": 14.05}}, "44000": {"_0": {"wer": 2.7251, "cer": 1.023, "pitch_ser": 2.7807, "rhythm_ser": 1.4684, "seqer": 15.4}}, "46000": {"_0": {"wer": 3.042, "cer": 0.9423, "pitch_ser": 3.001, "rhythm_ser": 1.7102, "seqer": 20.65}}, "48000": {"_0": {"wer": 2.1183, "cer": 0.7721, "pitch_ser": 2.0145, "rhythm_ser": 1.2058, "seqer": 11.25}}, "50000": {"_0": {"wer": 3.2505, "cer": 1.0991, "pitch_ser": 3.3809, "rhythm_ser": 1.4924, "seqer": 16.1}}, "52000": {"_0": {"wer": 2.2935, "cer": 0.7956, "pitch_ser": 2.2699, "rhythm_ser": 1.3018, "seqer": 12.5}}, "54000": {"_0": {"wer": 2.0224, "cer": 0.6836, "pitch_ser": 1.9794, "rhythm_ser": 0.9624, "seqer": 11.5}}, "56000": {"_0": {"wer": 2.1309, "cer": 0.8436, "pitch_ser": 2.1997, "rhythm_ser": 1.0649, "seqer": 10.95}}, "58000": {"_0": {"wer": 1.7535, "cer": 0.6001, "pitch_ser": 1.6378, "rhythm_ser": 1.0216, "seqer": 10.75}}, "60000": {"_0": {"wer": 2.8481, "cer": 1.0659, "pitch_ser": 3.0201, "rhythm_ser": 1.5004, "seqer": 13.95}}, "62000": {"_0": {"wer": 2.7146, "cer": 1.1406, "pitch_ser": 2.902, "rhythm_ser": 1.4043, "seqer": 12.25}}, "64000": {"_0": {"wer": 2.7918, "cer": 1.0281, "pitch_ser": 2.7647, "rhythm_ser": 1.6061, "seqer": 15.45}}, "66000": {"_0": {"wer": 1.939, "cer": 0.7643, "pitch_ser": 2.0177, "rhythm_ser": 0.972, "seqer": 10.35}}, "68000": {"_0": {"wer": 2.2163, "cer": 0.8704, "pitch_ser": 2.3146, "rhythm_ser": 1.2074, "seqer": 10.25}}, "70000": {"_0": {"wer": 1.9307, "cer": 0.6886, "pitch_ser": 1.9155, "rhythm_ser": 0.9896, "seqer": 11.0}}, "72000": {"_0": {"wer": 2.2017, "cer": 0.7896, "pitch_ser": 2.1965, "rhythm_ser": 1.233, "seqer": 10.2}}, "74000": {"_0": {"wer": 2.2705, "cer": 0.8676, "pitch_ser": 2.305, "rhythm_ser": 1.2058, "seqer": 10.4}}, "76000": {"_0": {"wer": 1.8827, "cer": 0.7315, "pitch_ser": 1.89, "rhythm_ser": 0.9784, "seqer": 9.35}}, "78000": {"_0": {"wer": 1.8536, "cer": 0.6683, "pitch_ser": 1.9123, "rhythm_ser": 0.9592, "seqer": 9.7}}, "80000": {"_0": {"wer": 1.8494, "cer": 0.6992, "pitch_ser": 1.874, "rhythm_ser": 0.9223, "seqer": 9.15}}, "82000": {"_0": {"wer": 1.9015, "cer": 0.6443, "pitch_ser": 1.9411, "rhythm_ser": 1.0969, "seqer": 9.55}}, "84000": {"_0": {"wer": 2.7313, "cer": 0.9543, "pitch_ser": 2.7935, "rhythm_ser": 1.4396, "seqer": 13.3}}, "86000": {"_0": {"wer": 3.0858, "cer": 1.1941, "pitch_ser": 3.3649, "rhythm_ser": 1.6365, "seqer": 14.3}}, "88000": {"_0": {"wer": 2.1746, "cer": 0.767, "pitch_ser": 2.139, "rhythm_ser": 1.2362, "seqer": 10.7}}, "90000": {"_0": {"wer": 1.7702, "cer": 0.5747, "pitch_ser": 1.6633, "rhythm_ser": 0.9287, "seqer": 9.6}}, "92000": {"_0": {"wer": 2.1517, "cer": 0.8727, "pitch_ser": 2.2156, "rhythm_ser": 1.1225, "seqer": 9.35}}, "94000": {"_0": {"wer": 1.7889, "cer": 0.6236, "pitch_ser": 1.7048, "rhythm_ser": 0.8919, "seqer": 9.35}}, "96000": {"_0": {"wer": 1.8369, "cer": 0.648, "pitch_ser": 1.7687, "rhythm_ser": 1.0937, "seqer": 9.25}}, "98000": {"_0": {"wer": 2.06, "cer": 0.78, "pitch_ser": 2.1773, "rhythm_ser": 1.0328, "seqer": 9.65}}, "100000": {"_0": {"wer": 1.766, "cer": 0.5807, "pitch_ser": 1.6793, "rhythm_ser": 0.9752, "seqer": 12.85}}, "102000": {"_0": {"wer": 1.7326, "cer": 0.6019, "pitch_ser": 1.7112, "rhythm_ser": 0.9912, "seqer": 8.55}}, "104000": {"_0": {"wer": 2.3039, "cer": 0.8685, "pitch_ser": 2.4199, "rhythm_ser": 1.305, "seqer": 10.75}}, "106000": {"_0": {"wer": 2.0308, "cer": 0.7426, "pitch_ser": 2.0336, "rhythm_ser": 1.2026, "seqer": 10.1}}, "108000": {"_0": {"wer": 1.6534, "cer": 0.6098, "pitch_ser": 1.558, "rhythm_ser": 0.8759, "seqer": 8.6}}, "110000": {"_0": {"wer": 2.0454, "cer": 0.7283, "pitch_ser": 2.0209, "rhythm_ser": 1.0697, "seqer": 10.25}}, "112000": {"_0": {"wer": 1.6221, "cer": 0.6254, "pitch_ser": 1.5835, "rhythm_ser": 0.8022, "seqer": 9.0}}, "114000": {"_0": {"wer": 1.497, "cer": 0.5489, "pitch_ser": 1.4909, "rhythm_ser": 0.7206, "seqer": 7.8}}, "116000": {"_0": {"wer": 1.4741, "cer": 0.5549, "pitch_ser": 1.4909, "rhythm_ser": 0.7398, "seqer": 7.65}}, "118000": {"_0": {"wer": 1.4699, "cer": 0.5659, "pitch_ser": 1.4398, "rhythm_ser": 0.7734, "seqer": 7.4}}, "120000": {"_0": {"wer": 1.424, "cer": 0.4931, "pitch_ser": 1.376, "rhythm_ser": 0.703, "seqer": 7.65}}}, # "122000": {"_0": {"wer": 1.3969, "cer": 0.4977, "pitch_ser": 1.3792, "rhythm_ser": 0.7174, "seqer": 7.3}}, "124000": {"_0": {"wer": 1.3636, "cer": 0.4894, "pitch_ser": 1.3026, "rhythm_ser": 0.6725, "seqer": 7.5}}, "126000": {"_0": {"wer": 1.4678, "cer": 0.5433, "pitch_ser": 1.4111, "rhythm_ser": 0.7462, "seqer": 7.25}}, "128000": {"_0": {"wer": 1.6409, "cer": 0.6116, "pitch_ser": 1.692, "rhythm_ser": 0.7782, "seqer": 7.8}}, "130000": {"_0": {"wer": 1.6221, "cer": 0.5872, "pitch_ser": 1.5771, "rhythm_ser": 0.8455, "seqer": 7.85}}, "132000": {"_0": {"wer": 1.497, "cer": 0.547, "pitch_ser": 1.4845, "rhythm_ser": 0.775, "seqer": 7.45}}, "134000": {"_0": {"wer": 1.3677, "cer": 0.5023, "pitch_ser": 1.3217, "rhythm_ser": 0.703, "seqer": 7.4}}, "136000": {"_0": {"wer": 1.8014, "cer": 0.7149, "pitch_ser": 1.8996, "rhythm_ser": 0.9592, "seqer": 7.65}}, "138000": {"_0": {"wer": 1.5033, "cer": 0.5724, "pitch_ser": 1.5005, "rhythm_ser": 0.7414, "seqer": 7.3}}, "140000": {"_0": {"wer": 1.497, "cer": 0.5659, "pitch_ser": 1.459, "rhythm_ser": 0.7798, "seqer": 7.55}}, "142000": {"_0": {"wer": 1.4866, "cer": 0.5673, "pitch_ser": 1.5324, "rhythm_ser": 0.7606, "seqer": 6.95}}, "144000": {"_0": {"wer": 1.4553, "cer": 0.5586, "pitch_ser": 1.4909, "rhythm_ser": 0.719, "seqer": 7.8}}, "146000": {"_0": {"wer": 1.4741, "cer": 0.5443, "pitch_ser": 1.4973, "rhythm_ser": 0.7382, "seqer": 7.2}}, "148000": {"_0": {"wer": 1.6242, "cer": 0.6347, "pitch_ser": 1.6761, "rhythm_ser": 0.8391, "seqer": 7.4}}, "150000": {"_0": {"wer": 1.4783, "cer": 0.5682, "pitch_ser": 1.4558, "rhythm_ser": 0.735, "seqer": 7.35}}, "152000": {"_0": {"wer": 1.3219, "cer": 0.4926, "pitch_ser": 1.293, "rhythm_ser": 0.6661, "seqer": 7.1}}, "154000": {"_0": {"wer": 1.4532, "cer": 0.5539, "pitch_ser": 1.4335, "rhythm_ser": 0.7286, "seqer": 7.7}}, "156000": {"_0": {"wer": 1.3636, "cer": 0.5286, "pitch_ser": 1.3409, "rhythm_ser": 0.6805, "seqer": 7.15}}, "158000": {"_0": {"wer": 1.7681, "cer": 0.7823, "pitch_ser": 1.8964, "rhythm_ser": 0.9351, "seqer": 7.7}}, "160000": {"_0": {"wer": 1.4657, "cer": 0.5899, "pitch_ser": 1.4335, "rhythm_ser": 0.7478, "seqer": 7.5}}, "162000": {"_0": {"wer": 1.3344, "cer": 0.5152, "pitch_ser": 1.3057, "rhythm_ser": 0.6725, "seqer": 7.25}}, "164000": {"_0": {"wer": 1.4741, "cer": 0.5908, "pitch_ser": 1.4973, "rhythm_ser": 0.7126, "seqer": 7.15}}, "166000": {"_0": {"wer": 1.3532, "cer": 0.5387, "pitch_ser": 1.3728, "rhythm_ser": 0.6998, "seqer": 7.3}}, "168000": {"_0": {"wer": 1.6242, "cer": 0.6762, "pitch_ser": 1.692, "rhythm_ser": 0.8327, "seqer": 7.65}}},
    'sagnostic Transformer': {"1000": {"": {"wer": 135.2833, "cer": 93.4746, "pitch_ser": 139.6901, "rhythm_ser": 120.0306, "seqer": 100.0}}, "2000": {"": {"wer": 85.0675, "cer": 51.8305, "pitch_ser": 85.0372, "rhythm_ser": 66.44, "seqer": 100.0}}, "3000": {"": {"wer": 46.5659, "cer": 30.1392, "pitch_ser": 44.3067, "rhythm_ser": 37.2081, "seqer": 98.75}}, "4000": {"": {"wer": 33.7201, "cer": 25.7853, "pitch_ser": 37.4229, "rhythm_ser": 28.0626, "seqer": 97.8}}, "5000": {"": {"wer": 16.78, "cer": 12.1837, "pitch_ser": 18.3146, "rhythm_ser": 13.0671, "seqer": 84.8}}, "6000": {"": {"wer": 15.8895, "cer": 12.2012, "pitch_ser": 17.6443, "rhythm_ser": 13.0275, "seqer": 82.7}}, "7000": {"": {"wer": 6.163, "cer": 4.3668, "pitch_ser": 6.2893, "rhythm_ser": 4.7113, "seqer": 44.95}}, "8000": {"": {"wer": 8.2317, "cer": 6.3568, "pitch_ser": 8.6324, "rhythm_ser": 6.78, "seqer": 55.1}}, "9000": {"": {"wer": 4.5008, "cer": 3.4783, "pitch_ser": 4.3383, "rhythm_ser": 3.7237, "seqer": 35.5}}, "10000": {"": {"wer": 4.9182, "cer": 4.0116, "pitch_ser": 5.268, "rhythm_ser": 4.2742, "seqer": 40.2}}, "11000": {"": {"wer": 3.0167, "cer": 2.235, "pitch_ser": 2.947, "rhythm_ser": 2.3763, "seqer": 28.65}}, "12000": {"": {"wer": 4.8516, "cer": 4.2072, "pitch_ser": 5.5336, "rhythm_ser": 4.3209, "seqer": 38.9}}, "13000": {"": {"wer": 2.2288, "cer": 1.6482, "pitch_ser": 2.0047, "rhythm_ser": 1.8241, "seqer": 24.45}}, "14000": {"": {"wer": 2.7235, "cer": 2.1716, "pitch_ser": 2.751, "rhythm_ser": 2.3206, "seqer": 25.0}}, "15000": {"": {"wer": 2.3565, "cer": 1.9224, "pitch_ser": 2.3209, "rhythm_ser": 2.0795, "seqer": 19.8}}, "16000": {"": {"wer": 2.0435, "cer": 1.4883, "pitch_ser": 1.9036, "rhythm_ser": 1.6496, "seqer": 20.65}}, "17000": {"": {"wer": 2.1389, "cer": 1.6725, "pitch_ser": 1.9225, "rhythm_ser": 1.8277, "seqer": 21.85}}, "18000": {"": {"wer": 1.6892, "cer": 1.2493, "pitch_ser": 1.5083, "rhythm_ser": 1.3851, "seqer": 17.0}}, "19000": {"": {"wer": 1.8672, "cer": 1.4355, "pitch_ser": 1.834, "rhythm_ser": 1.5452, "seqer": 15.55}}, "20000": {"": {"wer": 1.5039, "cer": 1.2224, "pitch_ser": 1.5273, "rhythm_ser": 1.306, "seqer": 11.85}}, "21000": {"": {"wer": 1.4733, "cer": 1.1346, "pitch_ser": 1.404, "rhythm_ser": 1.2196, "seqer": 12.25}}, "22000": {"": {"wer": 1.2664, "cer": 0.9549, "pitch_ser": 1.17, "rhythm_ser": 1.0398, "seqer": 10.85}}, "23000": {"": {"wer": 1.351, "cer": 1.0666, "pitch_ser": 1.404, "rhythm_ser": 1.1045, "seqer": 11.95}}, "24000": {"": {"wer": 0.9606, "cer": 0.721, "pitch_ser": 0.9328, "rhythm_ser": 0.7735, "seqer": 10.45}}, "25000": {"": {"wer": 1.1513, "cer": 0.8809, "pitch_ser": 1.1794, "rhythm_ser": 0.9588, "seqer": 9.95}}, "26000": {"": {"wer": 0.9318, "cer": 0.6655, "pitch_ser": 0.7526, "rhythm_ser": 0.7267, "seqer": 11.95}}, "27000": {"": {"wer": 1.2592, "cer": 1.0207, "pitch_ser": 1.4387, "rhythm_ser": 1.0613, "seqer": 10.05}}, "28000": {"": {"wer": 1.1225, "cer": 0.8436, "pitch_ser": 1.0119, "rhythm_ser": 0.93, "seqer": 12.95}}, "29000": {"": {"wer": 0.7915, "cer": 0.5082, "pitch_ser": 0.585, "rhythm_ser": 0.5918, "seqer": 8.75}}, "30000": {"": {"wer": 0.957, "cer": 0.7191, "pitch_ser": 0.9518, "rhythm_ser": 0.7753, "seqer": 9.9}}, "31000": {"": {"wer": 1.02, "cer": 0.7927, "pitch_ser": 1.1036, "rhythm_ser": 0.8329, "seqer": 8.45}}, "32000": {"": {"wer": 1.0505, "cer": 0.8349, "pitch_ser": 1.2016, "rhythm_ser": 0.8563, "seqer": 8.1}}, "33000": {"": {"wer": 1.3276, "cer": 1.1042, "pitch_ser": 1.4672, "rhythm_ser": 1.1333, "seqer": 10.8}}, "34000": {"": {"wer": 1.0505, "cer": 0.7996, "pitch_ser": 1.1289, "rhythm_ser": 0.8491, "seqer": 8.2}}, "35000": {"": {"wer": 0.957, "cer": 0.751, "pitch_ser": 1.0182, "rhythm_ser": 0.8005, "seqer": 8.05}}, "36000": {"": {"wer": 0.7573, "cer": 0.4927, "pitch_ser": 0.6261, "rhythm_ser": 0.5469, "seqer": 8.6}}, "37000": {"": {"wer": 0.9318, "cer": 0.689, "pitch_ser": 0.8538, "rhythm_ser": 0.7519, "seqer": 8.45}}, "38000": {"": {"wer": 0.8707, "cer": 0.6302, "pitch_ser": 0.7494, "rhythm_ser": 0.7124, "seqer": 9.1}}, "39000": {"": {"wer": 0.7303, "cer": 0.4915, "pitch_ser": 0.5787, "rhythm_ser": 0.5595, "seqer": 8.3}}, "40000": {"": {"wer": 1.4643, "cer": 1.1589, "pitch_ser": 1.5905, "rhythm_ser": 1.261, "seqer": 8.35}}, "41000": {"": {"wer": 0.93, "cer": 0.6955, "pitch_ser": 0.9138, "rhythm_ser": 0.7321, "seqer": 8.7}}, "42000": {"": {"wer": 0.7897, "cer": 0.5538, "pitch_ser": 0.5945, "rhythm_ser": 0.6296, "seqer": 8.0}}, "43000": {"": {"wer": 0.7124, "cer": 0.4965, "pitch_ser": 0.5565, "rhythm_ser": 0.5595, "seqer": 7.9}}, "44000": {"": {"wer": 1.1045, "cer": 0.7749, "pitch_ser": 0.9518, "rhythm_ser": 0.93, "seqer": 8.3}}, "46000": {"": {"wer": 0.7933, "cer": 0.5652, "pitch_ser": 0.7209, "rhythm_ser": 0.644, "seqer": 6.65}}, "47000": {"": {"wer": 0.5648, "cer": 0.3852, "pitch_ser": 0.4522, "rhythm_ser": 0.4299, "seqer": 6.2}}, "48000": {"": {"wer": 1.3887, "cer": 1.1506, "pitch_ser": 1.5273, "rhythm_ser": 1.2322, "seqer": 6.3}}, "49000": {"": {"wer": 0.8113, "cer": 0.5876, "pitch_ser": 0.7621, "rhythm_ser": 0.653, "seqer": 6.45}}, "50000": {"": {"wer": 0.8185, "cer": 0.5496, "pitch_ser": 0.5375, "rhythm_ser": 0.6692, "seqer": 6.25}}, "51000": {"": {"wer": 0.7357, "cer": 0.5325, "pitch_ser": 0.6893, "rhythm_ser": 0.5954, "seqer": 6.0}}, "52000": {"": {"wer": 0.6098, "cer": 0.4011, "pitch_ser": 0.4617, "rhythm_ser": 0.4569, "seqer": 6.3}}, "53000": {"": {"wer": 0.7501, "cer": 0.5686, "pitch_ser": 0.7589, "rhythm_ser": 0.6188, "seqer": 5.9}}, "54000": {"": {"wer": 0.6926, "cer": 0.4851, "pitch_ser": 0.6672, "rhythm_ser": 0.5361, "seqer": 5.85}}, "55000": {"": {"wer": 0.5307, "cer": 0.3259, "pitch_ser": 0.3889, "rhythm_ser": 0.3868, "seqer": 5.75}}, "56000": {"": {"wer": 0.5469, "cer": 0.354, "pitch_ser": 0.4269, "rhythm_ser": 0.403, "seqer": 5.6}}, "57000": {"": {"wer": 1.0272, "cer": 0.702, "pitch_ser": 0.781, "rhythm_ser": 0.8689, "seqer": 6.1}}, "58000": {"": {"wer": 0.7861, "cer": 0.5033, "pitch_ser": 0.5186, "rhythm_ser": 0.6404, "seqer": 5.9}}, "59000": {"": {"wer": 0.7214, "cer": 0.5341, "pitch_ser": 0.7083, "rhythm_ser": 0.5756, "seqer": 5.9}}, "60000": {"": {"wer": 0.5163, "cer": 0.3312, "pitch_ser": 0.4269, "rhythm_ser": 0.3742, "seqer": 5.75}}, "61000": {"": {"wer": 0.5595, "cer": 0.3609, "pitch_ser": 0.4617, "rhythm_ser": 0.4119, "seqer": 5.8}}, "62000": {"": {"wer": 0.7555, "cer": 0.5231, "pitch_ser": 0.683, "rhythm_ser": 0.5954, "seqer": 5.9}}, "63000": {"": {"wer": 0.5487, "cer": 0.365, "pitch_ser": 0.4648, "rhythm_ser": 0.403, "seqer": 5.55}}, "64000": {"": {"wer": 0.5055, "cer": 0.3274, "pitch_ser": 0.4395, "rhythm_ser": 0.3688, "seqer": 5.35}}, "65000": {"": {"wer": 0.4911, "cer": 0.2982, "pitch_ser": 0.4016, "rhythm_ser": 0.3418, "seqer": 5.35}}, "66000": {"": {"wer": 0.9984, "cer": 0.7965, "pitch_ser": 1.1225, "rhythm_ser": 0.8563, "seqer": 5.45}}, "67000": {"": {"wer": 0.6476, "cer": 0.4676, "pitch_ser": 0.6672, "rhythm_ser": 0.5037, "seqer": 5.25}}, "68000": {"": {"wer": 0.9156, "cer": 0.6609, "pitch_ser": 0.8379, "rhythm_ser": 0.7663, "seqer": 5.75}}, "69000": {"": {"wer": 0.707, "cer": 0.5155, "pitch_ser": 0.7336, "rhythm_ser": 0.5541, "seqer": 5.6}}, "70000": {"": {"wer": 0.8725, "cer": 0.6659, "pitch_ser": 0.9518, "rhythm_ser": 0.7196, "seqer": 5.6}}, "71000": {"": {"wer": 0.5163, "cer": 0.3225, "pitch_ser": 0.4174, "rhythm_ser": 0.3724, "seqer": 5.4}}, "72000": {"": {"wer": 0.5055, "cer": 0.3202, "pitch_ser": 0.3984, "rhythm_ser": 0.367, "seqer": 5.6}}, "73000": {"": {"wer": 0.5469, "cer": 0.3624, "pitch_ser": 0.4711, "rhythm_ser": 0.4012, "seqer": 5.3}}, "74000": {"": {"wer": 0.68, "cer": 0.5079, "pitch_ser": 0.7462, "rhythm_ser": 0.5361, "seqer": 5.25}}, "75000": {"": {"wer": 0.8023, "cer": 0.5998, "pitch_ser": 0.8253, "rhythm_ser": 0.6476, "seqer": 5.7}}, "76000": {"": {"wer": 0.5666, "cer": 0.3783, "pitch_ser": 0.4711, "rhythm_ser": 0.4209, "seqer": 5.4}}, "77000": {"": {"wer": 0.5235, "cer": 0.3289, "pitch_ser": 0.4364, "rhythm_ser": 0.3742, "seqer": 5.35}}, "78000": {"": {"wer": 0.5684, "cer": 0.3628, "pitch_ser": 0.4711, "rhythm_ser": 0.4101, "seqer": 5.7}}, "79000": {"": {"wer": 0.7609, "cer": 0.5751, "pitch_ser": 0.819, "rhythm_ser": 0.6134, "seqer": 5.5}}, "80000": {"": {"wer": 0.7951, "cer": 0.52, "pitch_ser": 0.5628, "rhythm_ser": 0.6458, "seqer": 5.5}}, "81000": {"": {"wer": 0.59, "cer": 0.3817, "pitch_ser": 0.5186, "rhythm_ser": 0.4245, "seqer": 5.7}}, "82000": {"": {"wer": 0.5864, "cer": 0.3901, "pitch_ser": 0.4933, "rhythm_ser": 0.4335, "seqer": 5.5}}, "83000": {"": {"wer": 0.6926, "cer": 0.5063, "pitch_ser": 0.7241, "rhythm_ser": 0.5541, "seqer": 5.3}}, "84000": {"": {"wer": 0.7232, "cer": 0.5094, "pitch_ser": 0.7115, "rhythm_ser": 0.5666, "seqer": 5.5}}, "85000": {"": {"wer": 0.5127, "cer": 0.3282, "pitch_ser": 0.4395, "rhythm_ser": 0.3634, "seqer": 5.45}}, "86000": {"": {"wer": 0.7663, "cer": 0.5424, "pitch_ser": 0.7431, "rhythm_ser": 0.6008, "seqer": 5.65}}, "87000": {"": {"wer": 0.7321, "cer": 0.528, "pitch_ser": 0.7336, "rhythm_ser": 0.5702, "seqer": 5.5}}, "88000": {"": {"wer": 0.7465, "cer": 0.5553, "pitch_ser": 0.7905, "rhythm_ser": 0.59, "seqer": 5.65}}, "89000": {"": {"wer": 0.5433, "cer": 0.359, "pitch_ser": 0.43, "rhythm_ser": 0.4047, "seqer": 5.45}}, "90000": {"": {"wer": 0.5307, "cer": 0.3506, "pitch_ser": 0.4522, "rhythm_ser": 0.3904, "seqer": 5.45}}, "91000": {"": {"wer": 0.6044, "cer": 0.4, "pitch_ser": 0.5028, "rhythm_ser": 0.4461, "seqer": 5.55}}, "92000": {"": {"wer": 0.6728, "cer": 0.4862, "pitch_ser": 0.702, "rhythm_ser": 0.5271, "seqer": 5.3}}, "93000": {"": {"wer": 0.8491, "cer": 0.5774, "pitch_ser": 0.6767, "rhythm_ser": 0.716, "seqer": 5.45}}, "94000": {"": {"wer": 0.5325, "cer": 0.3388, "pitch_ser": 0.43, "rhythm_ser": 0.3904, "seqer": 5.55}}, "95000": {"": {"wer": 0.6224, "cer": 0.4604, "pitch_ser": 0.6324, "rhythm_ser": 0.4767, "seqer": 5.2}}, "96000": {"": {"wer": 0.7591, "cer": 0.482, "pitch_ser": 0.4648, "rhythm_ser": 0.6188, "seqer": 5.45}}, "97000": {"": {"wer": 0.7124, "cer": 0.5196, "pitch_ser": 0.7304, "rhythm_ser": 0.5631, "seqer": 5.5}}, "98000": {"": {"wer": 0.8041, "cer": 0.555, "pitch_ser": 0.6862, "rhythm_ser": 0.6494, "seqer": 5.55}}, "99000": {"": {"wer": 0.5379, "cer": 0.3407, "pitch_ser": 0.4364, "rhythm_ser": 0.3886, "seqer": 5.45}}, "100000": {"": {"wer": 0.5577, "cer": 0.3624, "pitch_ser": 0.4806, "rhythm_ser": 0.4047, "seqer": 5.7}}, "101000": {"": {"wer": 0.5433, "cer": 0.3544, "pitch_ser": 0.4648, "rhythm_ser": 0.394, "seqer": 5.6}}, "102000": {"": {"wer": 0.4947, "cer": 0.3191, "pitch_ser": 0.4047, "rhythm_ser": 0.3598, "seqer": 5.15}}, "103000": {"": {"wer": 0.4929, "cer": 0.3084, "pitch_ser": 0.4047, "rhythm_ser": 0.3472, "seqer": 5.4}}, "104000": {"": {"wer": 0.8293, "cer": 0.5462, "pitch_ser": 0.6609, "rhythm_ser": 0.671, "seqer": 5.5}}, "105000": {"": {"wer": 0.5577, "cer": 0.3624, "pitch_ser": 0.4585, "rhythm_ser": 0.4119, "seqer": 5.35}}, "106000": {"": {"wer": 0.5738, "cer": 0.3897, "pitch_ser": 0.5123, "rhythm_ser": 0.4263, "seqer": 5.55}}, "107000": {"": {"wer": 0.4371, "cer": 0.2636, "pitch_ser": 0.3447, "rhythm_ser": 0.304, "seqer": 5.05}}, "108000": {"": {"wer": 0.5684, "cer": 0.3677, "pitch_ser": 0.4743, "rhythm_ser": 0.4083, "seqer": 5.6}}, "109000": {"": {"wer": 0.7771, "cer": 0.4972, "pitch_ser": 0.5502, "rhythm_ser": 0.6332, "seqer": 5.35}}},    
    'ssemantic Transformer': {"1000": {"": {"wer": 100.3982, "cer": 56.6123, "pitch_ser": 118.5423, "rhythm_ser": 82.4243, "seqer": 100.0}}, "3000": {"": {"wer": 50.2168, "cer": 29.4878, "pitch_ser": 51.3137, "rhythm_ser": 31.6381, "seqer": 98.85}}, "4000": {"": {"wer": 33.1346, "cer": 22.1943, "pitch_ser": 34.8753, "rhythm_ser": 25.3195, "seqer": 97.8}}, "5000": {"": {"wer": 19.5697, "cer": 13.5917, "pitch_ser": 21.339, "rhythm_ser": 14.1409, "seqer": 90.0}}, "6000": {"": {"wer": 12.3827, "cer": 8.4803, "pitch_ser": 13.8333, "rhythm_ser": 8.9944, "seqer": 66.65}}, "7000": {"": {"wer": 10.1977, "cer": 7.1815, "pitch_ser": 12.1508, "rhythm_ser": 6.6261, "seqer": 66.3}}, "8000": {"": {"wer": 8.488, "cer": 6.9661, "pitch_ser": 10.2864, "rhythm_ser": 7.0552, "seqer": 64.9}}, "9000": {"": {"wer": 5.0352, "cer": 3.7964, "pitch_ser": 5.7945, "rhythm_ser": 3.9616, "seqer": 40.45}}, "10000": {"": {"wer": 4.0595, "cer": 2.7757, "pitch_ser": 4.2269, "rhythm_ser": 2.9976, "seqer": 31.85}}, "11000": {"": {"wer": 3.2359, "cer": 2.1383, "pitch_ser": 3.4575, "rhythm_ser": 2.1745, "seqer": 25.9}}, "12000": {"": {"wer": 3.0274, "cer": 2.2043, "pitch_ser": 3.2532, "rhythm_ser": 2.277, "seqer": 25.35}}, "13000": {"": {"wer": 2.9878, "cer": 2.1895, "pitch_ser": 3.4192, "rhythm_ser": 2.3811, "seqer": 21.4}}, "14000": {"": {"wer": 1.9849, "cer": 1.3422, "pitch_ser": 2.1454, "rhythm_ser": 1.3483, "seqer": 16.45}}, "16000": {"": {"wer": 2.1309, "cer": 1.4547, "pitch_ser": 2.2827, "rhythm_ser": 1.4011, "seqer": 19.85}}, "17000": {"": {"wer": 1.7013, "cer": 1.1849, "pitch_ser": 1.8357, "rhythm_ser": 1.0857, "seqer": 15.5}}, "18000": {"": {"wer": 2.379, "cer": 1.8394, "pitch_ser": 2.7679, "rhythm_ser": 1.723, "seqer": 20.9}}, "19000": {"": {"wer": 2.06, "cer": 1.6577, "pitch_ser": 2.3848, "rhythm_ser": 1.5516, "seqer": 14.05}}, "20000": {"": {"wer": 2.4332, "cer": 1.9704, "pitch_ser": 2.9978, "rhythm_ser": 1.968, "seqer": 13.95}}, "21000": {"": {"wer": 1.5533, "cer": 1.0673, "pitch_ser": 1.6601, "rhythm_ser": 0.996, "seqer": 14.4}}, "22000": {"": {"wer": 1.1989, "cer": 0.7675, "pitch_ser": 1.2132, "rhythm_ser": 0.767, "seqer": 12.5}}, "23000": {"": {"wer": 1.5992, "cer": 1.232, "pitch_ser": 1.9155, "rhythm_ser": 1.0328, "seqer": 12.0}}, "24000": {"": {"wer": 1.7702, "cer": 1.3371, "pitch_ser": 2.0209, "rhythm_ser": 1.3002, "seqer": 13.9}}, "25000": {"": {"wer": 1.3135, "cer": 0.9266, "pitch_ser": 1.4015, "rhythm_ser": 0.8519, "seqer": 10.5}}, "26000": {"": {"wer": 1.693, "cer": 1.3749, "pitch_ser": 2.0528, "rhythm_ser": 1.2746, "seqer": 14.1}}, "27000": {"": {"wer": 0.957, "cer": 0.5742, "pitch_ser": 1.0025, "rhythm_ser": 0.522, "seqer": 9.7}}, "28000": {"": {"wer": 1.105, "cer": 0.6826, "pitch_ser": 1.178, "rhythm_ser": 0.6886, "seqer": 9.6}}, "29000": {"": {"wer": 1.1071, "cer": 0.6605, "pitch_ser": 1.1078, "rhythm_ser": 0.6853, "seqer": 10.85}}, "30000": {"": {"wer": 1.1509, "cer": 0.6711, "pitch_ser": 1.1142, "rhythm_ser": 0.6565, "seqer": 10.9}}, "31000": {"": {"wer": 0.9424, "cer": 0.5885, "pitch_ser": 0.9258, "rhythm_ser": 0.5588, "seqer": 9.05}}, "32000": {"": {"wer": 0.8861, "cer": 0.5281, "pitch_ser": 0.9929, "rhythm_ser": 0.4692, "seqer": 9.3}}, "33000": {"": {"wer": 1.0571, "cer": 0.7297, "pitch_ser": 1.1397, "rhythm_ser": 0.6661, "seqer": 9.05}}, "34000": {"": {"wer": 0.8945, "cer": 0.548, "pitch_ser": 0.9322, "rhythm_ser": 0.5252, "seqer": 8.15}}, "35000": {"": {"wer": 0.8861, "cer": 0.547, "pitch_ser": 0.8875, "rhythm_ser": 0.5316, "seqer": 8.6}}, "36000": {"": {"wer": 1.0821, "cer": 0.7956, "pitch_ser": 1.2036, "rhythm_ser": 0.7366, "seqer": 9.8}}, "37000": {"": {"wer": 1.1301, "cer": 0.8538, "pitch_ser": 1.3568, "rhythm_ser": 0.8231, "seqer": 9.15}}, "38000": {"": {"wer": 0.8423, "cer": 0.5074, "pitch_ser": 0.8684, "rhythm_ser": 0.4932, "seqer": 7.75}}, "39000": {"": {"wer": 1.2364, "cer": 0.6725, "pitch_ser": 1.0057, "rhythm_ser": 0.9015, "seqer": 9.6}}, "40000": {"": {"wer": 0.8173, "cer": 0.4778, "pitch_ser": 0.8556, "rhythm_ser": 0.442, "seqer": 7.85}}, "41000": {"": {"wer": 0.9257, "cer": 0.5599, "pitch_ser": 1.0567, "rhythm_ser": 0.4644, "seqer": 7.5}}, "42000": {"": {"wer": 0.8528, "cer": 0.5982, "pitch_ser": 0.9641, "rhythm_ser": 0.5653, "seqer": 7.15}}, "43000": {"": {"wer": 0.8423, "cer": 0.5641, "pitch_ser": 0.9354, "rhythm_ser": 0.4884, "seqer": 7.2}}, "44000": {"": {"wer": 0.982, "cer": 0.6683, "pitch_ser": 1.1365, "rhythm_ser": 0.5925, "seqer": 7.9}}, "45000": {"": {"wer": 0.7339, "cer": 0.4368, "pitch_ser": 0.7471, "rhythm_ser": 0.3987, "seqer": 7.1}}, "46000": {"": {"wer": 1.3865, "cer": 1.1065, "pitch_ser": 1.6378, "rhythm_ser": 1.0793, "seqer": 8.05}}, "47000": {"": {"wer": 0.7506, "cer": 0.4552, "pitch_ser": 0.8045, "rhythm_ser": 0.4003, "seqer": 7.55}}, "48000": {"": {"wer": 0.688, "cer": 0.3791, "pitch_ser": 0.7279, "rhythm_ser": 0.3587, "seqer": 6.55}}, "49000": {"": {"wer": 0.6151, "cer": 0.3575, "pitch_ser": 0.6577, "rhythm_ser": 0.3427, "seqer": 6.5}}, "50000": {"": {"wer": 0.6755, "cer": 0.4303, "pitch_ser": 0.696, "rhythm_ser": 0.4211, "seqer": 7.35}}, "51000": {"": {"wer": 0.6693, "cer": 0.3791, "pitch_ser": 0.7471, "rhythm_ser": 0.3331, "seqer": 6.2}}, "52000": {"": {"wer": 0.5254, "cer": 0.2901, "pitch_ser": 0.5523, "rhythm_ser": 0.2546, "seqer": 4.9}}, "53000": {"": {"wer": 0.4858, "cer": 0.2731, "pitch_ser": 0.5268, "rhythm_ser": 0.2322, "seqer": 5.3}}, "54000": {"": {"wer": 0.688, "cer": 0.4566, "pitch_ser": 0.7981, "rhythm_ser": 0.3779, "seqer": 4.95}}, "55000": {"": {"wer": 0.4712, "cer": 0.2463, "pitch_ser": 0.514, "rhythm_ser": 0.205, "seqer": 4.45}}, "56000": {"": {"wer": 0.4483, "cer": 0.2477, "pitch_ser": 0.4789, "rhythm_ser": 0.2178, "seqer": 4.55}}, "57000": {"": {"wer": 0.417, "cer": 0.2228, "pitch_ser": 0.4438, "rhythm_ser": 0.1793, "seqer": 4.4}}, "58000": {"": {"wer": 0.5629, "cer": 0.3183, "pitch_ser": 0.6321, "rhythm_ser": 0.2722, "seqer": 5.15}}, "59000": {"": {"wer": 0.638, "cer": 0.4123, "pitch_ser": 0.7694, "rhythm_ser": 0.3939, "seqer": 4.35}}, "60000": {"": {"wer": 0.4733, "cer": 0.2583, "pitch_ser": 0.5044, "rhythm_ser": 0.2162, "seqer": 4.75}}, "61000": {"": {"wer": 0.5067, "cer": 0.2601, "pitch_ser": 0.5747, "rhythm_ser": 0.205, "seqer": 4.8}}, "62000": {"": {"wer": 0.5004, "cer": 0.2597, "pitch_ser": 0.5555, "rhythm_ser": 0.2226, "seqer": 4.4}}, "63000": {"": {"wer": 0.4629, "cer": 0.2546, "pitch_ser": 0.498, "rhythm_ser": 0.2226, "seqer": 4.45}}, "64000": {"": {"wer": 0.3982, "cer": 0.19, "pitch_ser": 0.4246, "rhythm_ser": 0.1665, "seqer": 3.9}}, "65000": {"": {"wer": 0.3649, "cer": 0.1882, "pitch_ser": 0.4086, "rhythm_ser": 0.1473, "seqer": 3.4}}, "66000": {"": {"wer": 0.367, "cer": 0.1748, "pitch_ser": 0.4118, "rhythm_ser": 0.1345, "seqer": 3.55}}, "67000": {"": {"wer": 0.3649, "cer": 0.1753, "pitch_ser": 0.4086, "rhythm_ser": 0.1297, "seqer": 3.55}}, "68000": {"": {"wer": 0.3232, "cer": 0.1545, "pitch_ser": 0.348, "rhythm_ser": 0.1249, "seqer": 3.4}}, "69000": {"": {"wer": 0.3232, "cer": 0.1545, "pitch_ser": 0.348, "rhythm_ser": 0.1201, "seqer": 3.2}}, "70000": {"": {"wer": 0.3294, "cer": 0.1568, "pitch_ser": 0.3576, "rhythm_ser": 0.1169, "seqer": 3.2}}, "71000": {"": {"wer": 0.3253, "cer": 0.1554, "pitch_ser": 0.3384, "rhythm_ser": 0.1233, "seqer": 3.35}}, "72000": {"": {"wer": 0.3253, "cer": 0.1508, "pitch_ser": 0.3512, "rhythm_ser": 0.1073, "seqer": 3.2}}, "73000": {"": {"wer": 0.3107, "cer": 0.1476, "pitch_ser": 0.348, "rhythm_ser": 0.1025, "seqer": 3.1}}, "74000": {"": {"wer": 0.3357, "cer": 0.1587, "pitch_ser": 0.3608, "rhythm_ser": 0.1281, "seqer": 3.35}}, "75000": {"": {"wer": 0.3378, "cer": 0.1762, "pitch_ser": 0.3576, "rhythm_ser": 0.1393, "seqer": 3.45}}, "76000": {"": {"wer": 0.3544, "cer": 0.1739, "pitch_ser": 0.4086, "rhythm_ser": 0.1265, "seqer": 3.45}}, "77000": {"": {"wer": 0.3169, "cer": 0.1531, "pitch_ser": 0.3512, "rhythm_ser": 0.1137, "seqer": 3.1}}, "78000": {"": {"wer": 0.3023, "cer": 0.1476, "pitch_ser": 0.3288, "rhythm_ser": 0.1105, "seqer": 3.1}}, "79000": {"": {"wer": 0.3315, "cer": 0.1554, "pitch_ser": 0.3735, "rhythm_ser": 0.1089, "seqer": 3.05}}, "80000": {"": {"wer": 0.3211, "cer": 0.1619, "pitch_ser": 0.3639, "rhythm_ser": 0.1233, "seqer": 3.25}}, "81000": {"": {"wer": 0.3107, "cer": 0.1499, "pitch_ser": 0.3448, "rhythm_ser": 0.1073, "seqer": 3.25}}, "82000": {"": {"wer": 0.3461, "cer": 0.1568, "pitch_ser": 0.3895, "rhythm_ser": 0.1025, "seqer": 2.95}}, "83000": {"": {"wer": 0.3002, "cer": 0.1434, "pitch_ser": 0.332, "rhythm_ser": 0.1057, "seqer": 3.1}}, "84000": {"": {"wer": 0.3148, "cer": 0.155, "pitch_ser": 0.3512, "rhythm_ser": 0.1105, "seqer": 3.1}}, "85000": {"": {"wer": 0.3232, "cer": 0.1568, "pitch_ser": 0.3671, "rhythm_ser": 0.1153, "seqer": 3.2}}, "86000": {"": {"wer": 0.3023, "cer": 0.1416, "pitch_ser": 0.3288, "rhythm_ser": 0.1041, "seqer": 3.05}}, "87000": {"": {"wer": 0.3232, "cer": 0.161, "pitch_ser": 0.3671, "rhythm_ser": 0.1137, "seqer": 3.1}}, "88000": {"": {"wer": 0.3127, "cer": 0.1522, "pitch_ser": 0.3544, "rhythm_ser": 0.1089, "seqer": 3.15}}, "89000": {"": {"wer": 0.294, "cer": 0.1384, "pitch_ser": 0.3224, "rhythm_ser": 0.1009, "seqer": 3.0}}, "90000": {"": {"wer": 0.3086, "cer": 0.1434, "pitch_ser": 0.3384, "rhythm_ser": 0.1089, "seqer": 3.1}}, "91000": {"": {"wer": 0.3127, "cer": 0.149, "pitch_ser": 0.3576, "rhythm_ser": 0.1137, "seqer": 3.1}}, "92000": {"": {"wer": 0.294, "cer": 0.1402, "pitch_ser": 0.3288, "rhythm_ser": 0.1073, "seqer": 3.0}}, "93000": {"": {"wer": 0.3065, "cer": 0.1504, "pitch_ser": 0.3448, "rhythm_ser": 0.1073, "seqer": 3.1}}, "94000": {"": {"wer": 0.3273, "cer": 0.1554, "pitch_ser": 0.3608, "rhythm_ser": 0.1137, "seqer": 3.25}}, "95000": {"": {"wer": 0.2856, "cer": 0.1319, "pitch_ser": 0.3161, "rhythm_ser": 0.1009, "seqer": 2.95}}, "96000": {"": {"wer": 0.2961, "cer": 0.1467, "pitch_ser": 0.3193, "rhythm_ser": 0.1057, "seqer": 3.15}}, "97000": {"": {"wer": 0.319, "cer": 0.1531, "pitch_ser": 0.348, "rhythm_ser": 0.1137, "seqer": 3.25}}, "98000": {"": {"wer": 0.3044, "cer": 0.1398, "pitch_ser": 0.3129, "rhythm_ser": 0.1089, "seqer": 3.05}}, "99000": {"": {"wer": 0.3107, "cer": 0.1504, "pitch_ser": 0.3352, "rhythm_ser": 0.1169, "seqer": 2.9}}, "100000": {"": {"wer": 0.3169, "cer": 0.1531, "pitch_ser": 0.3416, "rhythm_ser": 0.1073, "seqer": 3.0}}, "101000": {"": {"wer": 0.3232, "cer": 0.1642, "pitch_ser": 0.3576, "rhythm_ser": 0.1297, "seqer": 3.3}}, "102000": {"": {"wer": 0.3107, "cer": 0.1559, "pitch_ser": 0.3448, "rhythm_ser": 0.1201, "seqer": 3.05}}, "103000": {"": {"wer": 0.3127, "cer": 0.1467, "pitch_ser": 0.3256, "rhythm_ser": 0.1121, "seqer": 3.15}}, "104000": {"": {"wer": 0.3148, "cer": 0.1541, "pitch_ser": 0.3512, "rhythm_ser": 0.1137, "seqer": 3.2}}, "105000": {"": {"wer": 0.3086, "cer": 0.1476, "pitch_ser": 0.3352, "rhythm_ser": 0.1057, "seqer": 2.9}}, "106000": {"": {"wer": 0.3169, "cer": 0.1531, "pitch_ser": 0.3352, "rhythm_ser": 0.1137, "seqer": 3.05}}, "107000": {"": {"wer": 0.294, "cer": 0.1462, "pitch_ser": 0.3161, "rhythm_ser": 0.1089, "seqer": 2.9}}, "108000": {"": {"wer": 0.2898, "cer": 0.1411, "pitch_ser": 0.3224, "rhythm_ser": 0.1041, "seqer": 2.8}}, "109000": {"": {"wer": 0.3169, "cer": 0.1587, "pitch_ser": 0.3416, "rhythm_ser": 0.1137, "seqer": 3.05}}, "110000": {"": {"wer": 0.2961, "cer": 0.1453, "pitch_ser": 0.3161, "rhythm_ser": 0.1073, "seqer": 2.9}}, "111000": {"": {"wer": 0.2856, "cer": 0.137, "pitch_ser": 0.3065, "rhythm_ser": 0.1009, "seqer": 2.8}}, "112000": {"": {"wer": 0.3065, "cer": 0.1411, "pitch_ser": 0.3161, "rhythm_ser": 0.1009, "seqer": 3.05}}}
}

results_only_sers = {}

for experiment, result in results.items():
    results_only_sers[experiment] = {}

    for iter_, data in result.items():
        if int(iter_) >= 0: #7000:
            if "_0" in data:
                results_only_sers[experiment][int(iter_)] = data["_0"]["wer"]
            elif "" in data:
                results_only_sers[experiment][int(iter_)] = data[""]["wer"]

for experiment, result in results_only_sers.items():
    print(f"'{experiment}': {result}")

plot_chart(results_only_sers, name='mono_sers_full')

# %% POLY results Transformer vs CTC

results = {
    'CRNN-CTC': {"0": {"_0": {"wer": 100.0, "cer": 99.9455, "pitch_ser": 99.7439, "rhythm_ser": 100.0, "seqer": 100.0}, "_1": {"wer": 100.0, "cer": 99.9102, "pitch_ser": 100.0, "rhythm_ser": 100.0, "seqer": 100.0}}, "2000": {"_0": {"wer": 73.605, "cer": 56.6976, "pitch_ser": 93.7642, "rhythm_ser": 65.2913, "seqer": 100.0}, "_1": {"wer": 89.8596, "cer": 80.7805, "pitch_ser": 95.6454, "rhythm_ser": 86.3243, "seqer": 100.0}}, "4000": {"_0": {"wer": 66.9196, "cer": 50.8351, "pitch_ser": 92.1764, "rhythm_ser": 56.9384, "seqer": 100.0}, "_1": {"wer": 82.489, "cer": 75.1119, "pitch_ser": 95.0084, "rhythm_ser": 75.8348, "seqer": 100.0}}, "6000": {"_0": {"wer": 68.2209, "cer": 50.9115, "pitch_ser": 95.5916, "rhythm_ser": 65.7834, "seqer": 100.0}, "_1": {"wer": 84.9241, "cer": 75.516, "pitch_ser": 98.1737, "rhythm_ser": 83.1238, "seqer": 100.0}}, "8000": {"_0": {"wer": 93.2543, "cer": 75.4088, "pitch_ser": 99.2354, "rhythm_ser": 94.4267, "seqer": 100.0}, "_1": {"wer": 96.032, "cer": 83.6154, "pitch_ser": 98.7066, "rhythm_ser": 95.2033, "seqer": 100.0}}, "10000": {"_0": {"wer": 71.0376, "cer": 54.5561, "pitch_ser": 93.413, "rhythm_ser": 67.6805, "seqer": 100.0}, "_1": {"wer": 83.0054, "cer": 76.7378, "pitch_ser": 97.2832, "rhythm_ser": 81.1173, "seqer": 100.0}}, "12000": {"_0": {"wer": 62.8079, "cer": 45.4482, "pitch_ser": 90.2612, "rhythm_ser": 55.3432, "seqer": 99.85}, "_1": {"wer": 85.7324, "cer": 75.209, "pitch_ser": 95.8891, "rhythm_ser": 82.4012, "seqer": 100.0}}, "14000": {"_0": {"wer": 67.6557, "cer": 50.5311, "pitch_ser": 91.5563, "rhythm_ser": 60.1766, "seqer": 99.95}, "_1": {"wer": 89.3268, "cer": 79.7073, "pitch_ser": 96.3181, "rhythm_ser": 86.3692, "seqer": 100.0}}, "16000": {"_0": {"wer": 60.3659, "cer": 43.9966, "pitch_ser": 88.1759, "rhythm_ser": 48.5744, "seqer": 99.7}, "_1": {"wer": 82.6972, "cer": 72.8946, "pitch_ser": 93.5558, "rhythm_ser": 74.6203, "seqer": 100.0}}, "18000": {"_0": {"wer": 65.4983, "cer": 47.7983, "pitch_ser": 89.4838, "rhythm_ser": 56.9575, "seqer": 99.85}, "_1": {"wer": 85.3527, "cer": 75.3479, "pitch_ser": 95.7981, "rhythm_ser": 80.7295, "seqer": 100.0}}, "20000": {"_0": {"wer": 58.0157, "cer": 42.1736, "pitch_ser": 88.1393, "rhythm_ser": 46.3835, "seqer": 99.95}, "_1": {"wer": 75.645, "cer": 68.372, "pitch_ser": 94.1863, "rhythm_ser": 66.3884, "seqer": 100.0}}, "22000": {"_0": {"wer": 60.5235, "cer": 43.3841, "pitch_ser": 89.0247, "rhythm_ser": 50.7287, "seqer": 98.2}, "_1": {"wer": 83.9872, "cer": 73.8774, "pitch_ser": 95.3399, "rhythm_ser": 78.3414, "seqer": 100.0}}, "24000": {"_0": {"wer": 66.6648, "cer": 51.0986, "pitch_ser": 93.8465, "rhythm_ser": 61.8125, "seqer": 99.2}, "_1": {"wer": 89.0962, "cer": 81.8598, "pitch_ser": 97.566, "rhythm_ser": 86.1018, "seqer": 100.0}}, "26000": {"_0": {"wer": 61.2933, "cer": 44.6116, "pitch_ser": 88.646, "rhythm_ser": 52.0165, "seqer": 98.55}, "_1": {"wer": 86.0324, "cer": 73.6608, "pitch_ser": 96.5261, "rhythm_ser": 81.8807, "seqer": 100.0}}, "28000": {"_0": {"wer": 58.9643, "cer": 41.5283, "pitch_ser": 86.1729, "rhythm_ser": 46.7387, "seqer": 99.0}, "_1": {"wer": 81.8338, "cer": 71.9161, "pitch_ser": 93.2406, "rhythm_ser": 73.8386, "seqer": 100.0}}, "30000": {"_0": {"wer": 59.7215, "cer": 43.0131, "pitch_ser": 87.1954, "rhythm_ser": 48.8834, "seqer": 98.25}, "_1": {"wer": 87.5184, "cer": 79.1941, "pitch_ser": 96.4383, "rhythm_ser": 83.8361, "seqer": 100.0}}, "32000": {"_0": {"wer": 60.917, "cer": 43.6401, "pitch_ser": 88.6131, "rhythm_ser": 51.3818, "seqer": 98.95}, "_1": {"wer": 82.787, "cer": 72.1023, "pitch_ser": 94.4592, "rhythm_ser": 75.9716, "seqer": 100.0}}, "34000": {"_0": {"wer": 55.769, "cer": 39.7557, "pitch_ser": 83.7986, "rhythm_ser": 43.8031, "seqer": 97.85}, "_1": {"wer": 81.3663, "cer": 70.505, "pitch_ser": 92.7532, "rhythm_ser": 72.3669, "seqer": 100.0}}, "36000": {"_0": {"wer": 53.1663, "cer": 37.7906, "pitch_ser": 83.6669, "rhythm_ser": 39.5143, "seqer": 97.45}, "_1": {"wer": 78.3087, "cer": 69.7103, "pitch_ser": 93.5461, "rhythm_ser": 69.3052, "seqer": 100.0}}, "38000": {"_0": {"wer": 52.137, "cer": 36.8231, "pitch_ser": 82.584, "rhythm_ser": 37.7224, "seqer": 97.15}, "_1": {"wer": 80.109, "cer": 70.4109, "pitch_ser": 92.1617, "rhythm_ser": 70.8932, "seqer": 100.0}}, "40000": {"_0": {"wer": 54.6056, "cer": 40.8898, "pitch_ser": 82.6553, "rhythm_ser": 39.95, "seqer": 100.0}, "_1": {"wer": 81.7378, "cer": 70.0882, "pitch_ser": 94.1245, "rhythm_ser": 75.1347, "seqer": 100.0}}, "42000": {"_0": {"wer": 55.0783, "cer": 41.92, "pitch_ser": 83.3413, "rhythm_ser": 40.9853, "seqer": 100.0}, "_1": {"wer": 80.6152, "cer": 70.3673, "pitch_ser": 93.2731, "rhythm_ser": 73.9794, "seqer": 100.0}}, "44000": {"_0": {"wer": 57.1824, "cer": 43.2457, "pitch_ser": 84.1553, "rhythm_ser": 42.9294, "seqer": 100.0}, "_1": {"wer": 77.7004, "cer": 67.2715, "pitch_ser": 90.9366, "rhythm_ser": 66.7558, "seqer": 100.0}}, "46000": {"_0": {"wer": 55.8074, "cer": 41.3842, "pitch_ser": 82.5693, "rhythm_ser": 39.6346, "seqer": 100.0}, "_1": {"wer": 78.8027, "cer": 66.8772, "pitch_ser": 90.9691, "rhythm_ser": 67.1599, "seqer": 100.0}}, "48000": {"_0": {"wer": 55.0242, "cer": 42.0029, "pitch_ser": 81.8742, "rhythm_ser": 39.5852, "seqer": 100.0}, "_1": {"wer": 78.2454, "cer": 68.6262, "pitch_ser": 91.242, "rhythm_ser": 68.3377, "seqer": 100.0}}, "50000": {"_0": {"wer": 54.4512, "cer": 41.7364, "pitch_ser": 81.673, "rhythm_ser": 38.6224, "seqer": 100.0}, "_1": {"wer": 78.1801, "cer": 68.8937, "pitch_ser": 90.9821, "rhythm_ser": 68.5418, "seqer": 100.0}}, "52000": {"_0": {"wer": 54.4786, "cer": 40.6605, "pitch_ser": 82.6023, "rhythm_ser": 38.8071, "seqer": 100.0}, "_1": {"wer": 74.4326, "cer": 64.4421, "pitch_ser": 90.7838, "rhythm_ser": 61.5039, "seqer": 100.0}}, "54000": {"_0": {"wer": 54.02, "cer": 40.0742, "pitch_ser": 81.4846, "rhythm_ser": 37.6523, "seqer": 100.0}, "_1": {"wer": 74.2387, "cer": 64.0071, "pitch_ser": 89.8544, "rhythm_ser": 61.359, "seqer": 100.0}}, "56000": {"_0": {"wer": 53.6484, "cer": 39.7493, "pitch_ser": 81.3401, "rhythm_ser": 37.3146, "seqer": 100.0}, "_1": {"wer": 74.4591, "cer": 64.0811, "pitch_ser": 89.7569, "rhythm_ser": 61.657, "seqer": 100.0}}, "58000": {"_0": {"wer": 53.4658, "cer": 39.5424, "pitch_ser": 81.3437, "rhythm_ser": 36.6974, "seqer": 100.0}, "_1": {"wer": 74.7571, "cer": 64.1478, "pitch_ser": 89.7927, "rhythm_ser": 61.9101, "seqer": 100.0}}, "60000": {"_0": {"wer": 53.0636, "cer": 39.2696, "pitch_ser": 81.1517, "rhythm_ser": 36.0037, "seqer": 100.0}, "_1": {"wer": 74.8592, "cer": 64.2376, "pitch_ser": 89.8804, "rhythm_ser": 61.8958, "seqer": 100.0}}, "62000": {"_0": {"wer": 53.5622, "cer": 39.5044, "pitch_ser": 81.3492, "rhythm_ser": 36.6552, "seqer": 100.0}, "_1": {"wer": 75.5511, "cer": 64.6574, "pitch_ser": 89.8707, "rhythm_ser": 62.7735, "seqer": 100.0}}, "64000": {"_0": {"wer": 52.8033, "cer": 39.1235, "pitch_ser": 81.031, "rhythm_ser": 35.8429, "seqer": 100.0}, "_1": {"wer": 75.4511, "cer": 64.561, "pitch_ser": 90.1274, "rhythm_ser": 62.7735, "seqer": 100.0}}, "66000": {"_0": {"wer": 52.4811, "cer": 38.838, "pitch_ser": 80.195, "rhythm_ser": 35.3061, "seqer": 100.0}, "_1": {"wer": 75.3613, "cer": 64.3947, "pitch_ser": 89.5132, "rhythm_ser": 62.4592, "seqer": 100.0}}, "68000": {"_0": {"wer": 52.6238, "cer": 38.9779, "pitch_ser": 80.4712, "rhythm_ser": 35.4606, "seqer": 100.0}, "_1": {"wer": 75.247, "cer": 64.4627, "pitch_ser": 89.6562, "rhythm_ser": 62.4551, "seqer": 100.0}}, "70000": {"_0": {"wer": 52.5313, "cer": 38.9504, "pitch_ser": 80.4712, "rhythm_ser": 35.3443, "seqer": 100.0}, "_1": {"wer": 75.4286, "cer": 64.3917, "pitch_ser": 89.8122, "rhythm_ser": 62.6245, "seqer": 100.0}}, "72000": {"_0": {"wer": 52.7751, "cer": 39.2009, "pitch_ser": 80.7182, "rhythm_ser": 36.2434, "seqer": 100.0}, "_1": {"wer": 75.2858, "cer": 64.5707, "pitch_ser": 89.8999, "rhythm_ser": 63.2266, "seqer": 100.0}}, "74000": {"_0": {"wer": 52.7547, "cer": 39.2067, "pitch_ser": 80.8956, "rhythm_ser": 35.8484, "seqer": 100.0}, "_1": {"wer": 75.494, "cer": 64.564, "pitch_ser": 89.9032, "rhythm_ser": 62.7572, "seqer": 100.0}}, "76000": {"_0": {"wer": 52.8214, "cer": 39.2974, "pitch_ser": 80.581, "rhythm_ser": 36.3151, "seqer": 100.0}, "_1": {"wer": 75.7164, "cer": 64.6902, "pitch_ser": 89.6107, "rhythm_ser": 63.4451, "seqer": 100.0}}, "78000": {"_0": {"wer": 52.293, "cer": 38.872, "pitch_ser": 80.4474, "rhythm_ser": 35.0886, "seqer": 100.0}, "_1": {"wer": 75.2306, "cer": 64.4584, "pitch_ser": 89.6659, "rhythm_ser": 62.4939, "seqer": 100.0}}, "80000": {"_0": {"wer": 52.6458, "cer": 39.0805, "pitch_ser": 80.4182, "rhythm_ser": 35.5761, "seqer": 100.0}, "_1": {"wer": 75.5266, "cer": 64.4578, "pitch_ser": 89.8674, "rhythm_ser": 62.7286, "seqer": 100.0}}, "82000": {"_0": {"wer": 52.4161, "cer": 38.8617, "pitch_ser": 80.4968, "rhythm_ser": 34.9779, "seqer": 100.0}, "_1": {"wer": 75.347, "cer": 64.3432, "pitch_ser": 89.8999, "rhythm_ser": 62.2857, "seqer": 100.0}}, "84000": {"_0": {"wer": 52.565, "cer": 38.8972, "pitch_ser": 80.698, "rhythm_ser": 35.0878, "seqer": 100.0}, "_1": {"wer": 75.3919, "cer": 64.379, "pitch_ser": 89.7472, "rhythm_ser": 62.5204, "seqer": 100.0}}, "86000": {"_0": {"wer": 52.8739, "cer": 39.2032, "pitch_ser": 80.6249, "rhythm_ser": 35.9201, "seqer": 100.0}, "_1": {"wer": 75.4409, "cer": 64.4439, "pitch_ser": 89.4514, "rhythm_ser": 63.2552, "seqer": 100.0}}, "88000": {"_0": {"wer": 52.4192, "cer": 38.8237, "pitch_ser": 80.623, "rhythm_ser": 35.0432, "seqer": 100.0}, "_1": {"wer": 75.1613, "cer": 64.0823, "pitch_ser": 89.6984, "rhythm_ser": 62.253, "seqer": 100.0}}, "90000": {"_0": {"wer": 52.4067, "cer": 38.9819, "pitch_ser": 80.4401, "rhythm_ser": 35.3881, "seqer": 100.0}, "_1": {"wer": 75.2633, "cer": 64.4317, "pitch_ser": 89.4352, "rhythm_ser": 63.2471, "seqer": 100.0}}, "92000": {"_0": {"wer": 53.0542, "cer": 39.3508, "pitch_ser": 80.709, "rhythm_ser": 36.167, "seqer": 100.0}, "_1": {"wer": 75.3409, "cer": 64.3632, "pitch_ser": 89.8577, "rhythm_ser": 63.1328, "seqer": 100.0}}, "94000": {"_0": {"wer": 52.7657, "cer": 39.0661, "pitch_ser": 80.3487, "rhythm_ser": 35.7736, "seqer": 100.0}, "_1": {"wer": 75.0143, "cer": 64.1648, "pitch_ser": 89.042, "rhythm_ser": 62.7409, "seqer": 100.0}}, "96000": {"_0": {"wer": 53.4893, "cer": 39.4555, "pitch_ser": 80.5535, "rhythm_ser": 36.1168, "seqer": 100.0}, "_1": {"wer": 75.4266, "cer": 64.2528, "pitch_ser": 89.2792, "rhythm_ser": 62.9899, "seqer": 100.0}}, "98000": {"_0": {"wer": 52.7775, "cer": 39.0591, "pitch_ser": 80.731, "rhythm_ser": 35.8731, "seqer": 100.0}, "_1": {"wer": 75.2776, "cer": 64.3438, "pitch_ser": 89.2857, "rhythm_ser": 63.3818, "seqer": 100.0}}, "100000": {"_0": {"wer": 52.9374, "cer": 39.0843, "pitch_ser": 80.5444, "rhythm_ser": 35.8237, "seqer": 100.0}, "_1": {"wer": 75.0959, "cer": 63.9549, "pitch_ser": 89.276, "rhythm_ser": 62.7429, "seqer": 100.0}}, "102000": {"_0": {"wer": 52.5431, "cer": 38.9494, "pitch_ser": 80.4895, "rhythm_ser": 35.4646, "seqer": 100.0}, "_1": {"wer": 75.892, "cer": 64.7278, "pitch_ser": 89.5912, "rhythm_ser": 63.5961, "seqer": 100.0}}},
    "Transformer": {"0": {"_0": {"wer": 100.00}, "_1": {"wer": 100.00}}, "10000": {"_0": {"wer": 36.3198, "cer": 27.9934, "pitch_ser": 58.952, "rhythm_ser": 21.0339, "seqer": 85.4839}, "_1": {"wer": 95.3118, "cer": 104.3591, "pitch_ser": 147.5682, "rhythm_ser": 97.5036, "seqer": 99.7382}}, "20000": {"_0": {"wer": 14.2647, "cer": 10.768, "pitch_ser": 20.5278, "rhythm_ser": 9.2043, "seqer": 54.5265}, "_1": {"wer": 46.4986, "cer": 31.8497, "pitch_ser": 52.5752, "rhythm_ser": 29.2537, "seqer": 96.0733}}, "30000": {"_0": {"wer": 10.87, "cer": 7.7747, "pitch_ser": 14.5872, "rhythm_ser": 6.9153, "seqer": 46.462}, "_1": {"wer": 37.2582, "cer": 23.7976, "pitch_ser": 35.0035, "rhythm_ser": 24.1924, "seqer": 92.9319}}, "40000": {"_0": {"wer": 14.7132, "cer": 11.7724, "pitch_ser": 18.5648, "rhythm_ser": 11.2281, "seqer": 45.0052}, "_1": {"wer": 49.508, "cer": 38.076, "pitch_ser": 50.8362, "rhythm_ser": 37.6341, "seqer": 92.6702}}, "50000": {"_0": {"wer": 9.924, "cer": 7.9213, "pitch_ser": 13.9933, "rhythm_ser": 6.7844, "seqer": 37.3049}, "_1": {"wer": 38.9983, "cer": 29.5333, "pitch_ser": 42.2463, "rhythm_ser": 28.0929, "seqer": 87.1728}}, "60000": {"_0": {"wer": 7.9314, "cer": 5.8807, "pitch_ser": 11.0335, "rhythm_ser": 5.0452, "seqer": 33.4027}, "_1": {"wer": 23.0514, "cer": 15.1979, "pitch_ser": 26.1127, "rhythm_ser": 13.5611, "seqer": 81.4136}}, "70000": {"_0": {"wer": 7.1256, "cer": 5.3301, "pitch_ser": 10.5828, "rhythm_ser": 4.3416, "seqer": 33.1946}, "_1": {"wer": 16.7739, "cer": 10.3935, "pitch_ser": 18.8104, "rhythm_ser": 9.1852, "seqer": 76.178}}, "80000": {"_0": {"wer": 6.895, "cer": 5.1604, "pitch_ser": 9.9947, "rhythm_ser": 4.3602, "seqer": 32.3101}, "_1": {"wer": 20.7009, "cer": 14.2594, "pitch_ser": 23.0161, "rhythm_ser": 12.88, "seqer": 75.9162}}, "90000": {"_0": {"wer": 6.759, "cer": 5.0385, "pitch_ser": 9.8171, "rhythm_ser": 4.2656, "seqer": 31.6857}, "_1": {"wer": 20.9397, "cer": 15.3669, "pitch_ser": 21.4731, "rhythm_ser": 15.2615, "seqer": 79.0576}}, "100000": {"_0": {"wer": 7.6898, "cer": 5.9888, "pitch_ser": 11.1996, "rhythm_ser": 5.1102, "seqer": 30.7492}, "_1": {"wer": 25.1609, "cer": 19.8635, "pitch_ser": 26.2946, "rhythm_ser": 19.5931, "seqer": 71.466}}, "110000": {"_0": {"wer": 6.8122, "cer": 5.2696, "pitch_ser": 9.5898, "rhythm_ser": 4.5595, "seqer": 30.2289}, "_1": {"wer": 15.6882, "cer": 11.1289, "pitch_ser": 16.7075, "rhythm_ser": 10.3018, "seqer": 75.1309}}, "120000": {"_0": {"wer": 6.3021, "cer": 4.7299, "pitch_ser": 9.1182, "rhythm_ser": 3.9598, "seqer": 29.1883}, "_1": {"wer": 18.0873, "cer": 12.8258, "pitch_ser": 19.7726, "rhythm_ser": 12.0111, "seqer": 70.1571}}, "130000": {"_0": {"wer": 6.2683, "cer": 4.6961, "pitch_ser": 9.1525, "rhythm_ser": 3.8855, "seqer": 28.8762}}, "140000": {"_0": {"wer": 6.6441, "cer": 5.0295, "pitch_ser": 9.3416, "rhythm_ser": 4.3264, "seqer": 27.4714}, "_1": {"wer": 15.1664, "cer": 10.1675, "pitch_ser": 15.8922, "rhythm_ser": 9.7313, "seqer": 64.9215}}, "150000": {"_0": {"wer": 6.139, "cer": 4.4736, "pitch_ser": 8.8375, "rhythm_ser": 3.7537, "seqer": 27.4714}, "_1": {"wer": 12.4577, "cer": 7.9487, "pitch_ser": 12.1379, "rhythm_ser": 7.6727, "seqer": 67.0157}}, "160000": {"_1": {"wer": 7.7855, "cer": 4.9439, "pitch_ser": 8.289, "rhythm_ser": 4.5439, "seqer": 55.4974}}, "170000": {"_0": {"wer": 5.6052, "cer": 4.1545, "pitch_ser": 7.8025, "rhythm_ser": 3.5121, "seqer": 22.6847}, "_1": {"wer": 8.1747, "cer": 5.2766, "pitch_ser": 8.4745, "rhythm_ser": 4.8999, "seqer": 54.1885}}, "180000": {"_0": {"wer": 5.3653, "cer": 3.8993, "pitch_ser": 7.6535, "rhythm_ser": 3.2342, "seqer": 22.8928}}, "190000": {"_0": {"wer": 5.552, "cer": 4.1529, "pitch_ser": 7.9476, "rhythm_ser": 3.4344, "seqer": 23.7253}, "_1": {"wer": 9.9303, "cer": 7.0246, "pitch_ser": 10.6018, "rhythm_ser": 6.5627, "seqer": 54.9738}}, "200000": {"_0": {"wer": 5.5452, "cer": 4.206, "pitch_ser": 8.0374, "rhythm_ser": 3.4842, "seqer": 22.6327}, "_1": {"wer": 7.613, "cer": 4.8915, "pitch_ser": 8.0931, "rhythm_ser": 4.3582, "seqer": 53.1414}}, "210000": {"_0": {"wer": 5.4126, "cer": 4.0143, "pitch_ser": 7.6669, "rhythm_ser": 3.355, "seqer": 22.9969}, "_1": {"wer": 7.319, "cer": 4.6748, "pitch_ser": 7.6522, "rhythm_ser": 4.4268, "seqer": 51.8325}}, "220000": {"_0": {"wer": 5.0367, "cer": 3.6383, "pitch_ser": 7.0635, "rhythm_ser": 2.9648, "seqer": 22.7888}, "_1": {"wer": 7.9536, "cer": 5.2, "pitch_ser": 7.8901, "rhythm_ser": 5.2405, "seqer": 53.4031}}, "230000": {"_0": {"wer": 5.1668, "cer": 3.8531, "pitch_ser": 7.3556, "rhythm_ser": 3.2004, "seqer": 23.7253}, "_1": {"wer": 7.5445, "cer": 4.9053, "pitch_ser": 7.6837, "rhythm_ser": 4.6899, "seqer": 54.1885}}, "240000": {"_0": {"wer": 5.6322, "cer": 4.1881, "pitch_ser": 8.2627, "rhythm_ser": 3.4361, "seqer": 23.6212}, "_1": {"wer": 8.4002, "cer": 5.5962, "pitch_ser": 9.1987, "rhythm_ser": 5.0348, "seqer": 54.9738}}, "250000": {"_0": {"wer": 5.28, "cer": 3.9961, "pitch_ser": 7.39, "rhythm_ser": 3.377, "seqer": 22.6847}, "_1": {"wer": 8.084, "cer": 5.105, "pitch_ser": 8.5759, "rhythm_ser": 4.3449, "seqer": 52.6178}}},
}

results_only_sers = get_only_sers(results)

plot_chart(results_only_sers, name='poly_sers_full')

# %% POLY Transformer comparison

results = {
    "1_less_layers": {"10000": {"_0": {"wer": 33.0746, "cer": 27.3254, "pitch_ser": 51.3921, "rhythm_ser": 23.1455, "seqer": 83.5588}, "_1": {"wer": 140.3273, "cer": 120.3554, "pitch_ser": 170.9237, "rhythm_ser": 112.0354, "seqer": 100.0}}, "20000": {"_0": {"wer": 14.263, "cer": 11.1789, "pitch_ser": 19.9473, "rhythm_ser": 9.9079, "seqer": 54.2664}, "_1": {"wer": 63.5312, "cer": 49.9175, "pitch_ser": 72.3828, "rhythm_ser": 47.6705, "seqer": 96.5969}}, "30000": {"_0": {"wer": 11.2881, "cer": 9.0998, "pitch_ser": 16.09, "rhythm_ser": 8.0581, "seqer": 49.7919}, "_1": {"wer": 72.4909, "cer": 62.9149, "pitch_ser": 82.5787, "rhythm_ser": 58.4809, "seqer": 96.0733}}, "40000": {"_0": {"wer": 9.9079, "cer": 7.7389, "pitch_ser": 13.4662, "rhythm_ser": 6.8393, "seqer": 48.3351}, "_1": {"wer": 46.1846, "cer": 36.6581, "pitch_ser": 46.6655, "rhythm_ser": 35.9469, "seqer": 90.0524}}, "50000": {"_0": {"wer": 8.0606, "cer": 6.351, "pitch_ser": 11.1652, "rhythm_ser": 5.6213, "seqer": 40.5827}, "_1": {"wer": 31.2482, "cer": 24.4243, "pitch_ser": 34.7551, "rhythm_ser": 22.9298, "seqer": 87.1728}}, "60000": {"_0": {"wer": 8.6941, "cer": 6.9031, "pitch_ser": 11.9921, "rhythm_ser": 6.1255, "seqer": 42.5078}, "_1": {"wer": 31.3057, "cer": 24.0609, "pitch_ser": 32.2218, "rhythm_ser": 24.1548, "seqer": 86.1257}}, "70000": {"_0": {"wer": 8.3115, "cer": 6.3428, "pitch_ser": 10.3155, "rhythm_ser": 5.9067, "seqer": 37.7211}, "_1": {"wer": 23.9425, "cer": 17.3329, "pitch_ser": 24.7026, "rhythm_ser": 16.9795, "seqer": 79.8429}}, "80000": {"_0": {"wer": 8.4331, "cer": 6.6011, "pitch_ser": 11.2569, "rhythm_ser": 5.9059, "seqer": 38.5016}, "_1": {"wer": 27.6329, "cer": 21.9285, "pitch_ser": 30.9062, "rhythm_ser": 20.9132, "seqer": 90.0524}}, "90000": {"_0": {"wer": 7.0352, "cer": 5.3224, "pitch_ser": 9.9412, "rhythm_ser": 4.6093, "seqer": 33.871}, "_1": {"wer": 24.3737, "cer": 19.4693, "pitch_ser": 27.3723, "rhythm_ser": 18.3173, "seqer": 77.7487}}, "100000": {"_0": {"wer": 7.1906, "cer": 5.585, "pitch_ser": 10.2715, "rhythm_ser": 4.7808, "seqer": 33.0385}, "_1": {"wer": 23.2836, "cer": 18.6958, "pitch_ser": 25.2974, "rhythm_ser": 18.2311, "seqer": 78.534}}, "110000": {"_0": {"wer": 6.8105, "cer": 5.2679, "pitch_ser": 9.5383, "rhythm_ser": 4.5097, "seqer": 33.7669}, "_1": {"wer": 20.0862, "cer": 14.5116, "pitch_ser": 19.2617, "rhythm_ser": 14.7816, "seqer": 81.1518}}, "120000": {"_1": {"wer": 18.4699, "cer": 13.3707, "pitch_ser": 17.7642, "rhythm_ser": 13.6407, "seqer": 77.2251}}, "130000": {"_0": {"wer": 6.7362, "cer": 5.3482, "pitch_ser": 9.4562, "rhythm_ser": 4.7099, "seqer": 31.6337}, "_1": {"wer": 14.1537, "cer": 10.0313, "pitch_ser": 14.4402, "rhythm_ser": 9.906, "seqer": 76.9634}}, "140000": {"_0": {"wer": 6.7582, "cer": 5.2619, "pitch_ser": 9.6395, "rhythm_ser": 4.4978, "seqer": 31.0614}, "_1": {"wer": 16.597, "cer": 11.5704, "pitch_ser": 16.0182, "rhythm_ser": 11.7546, "seqer": 78.2723}}, "150000": {"_0": {"wer": 5.9557, "cer": 4.5635, "pitch_ser": 8.509, "rhythm_ser": 3.9116, "seqer": 29.0323}, "_1": {"wer": 15.2106, "cer": 10.9698, "pitch_ser": 15.1435, "rhythm_ser": 10.8546, "seqer": 77.7487}}, "160000": {"_0": {"wer": 6.1331, "cer": 4.8218, "pitch_ser": 8.6389, "rhythm_ser": 4.187, "seqer": 25.6504}, "_1": {"wer": 11.8386, "cer": 8.0823, "pitch_ser": 11.522, "rhythm_ser": 8.2698, "seqer": 68.8482}}, "170000": {"_0": {"wer": 6.0647, "cer": 4.7093, "pitch_ser": 8.5529, "rhythm_ser": 4.0063, "seqer": 25.9625}, "_1": {"wer": 10.8347, "cer": 7.7018, "pitch_ser": 10.3814, "rhythm_ser": 7.8762, "seqer": 64.3979}}, "180000": {"_0": {"wer": 5.7463, "cer": 4.3545, "pitch_ser": 7.8598, "rhythm_ser": 3.7706, "seqer": 25.9625}, "_1": {"wer": 11.644, "cer": 8.3554, "pitch_ser": 11.2246, "rhythm_ser": 8.4069, "seqer": 69.8953}}, "190000": {"_1": {"wer": 10.5539, "cer": 7.356, "pitch_ser": 10.119, "rhythm_ser": 7.3566, "seqer": 64.6597}}, "200000": {"_0": {"wer": 5.5925, "cer": 4.2483, "pitch_ser": 7.77, "rhythm_ser": 3.6329, "seqer": 25.4943}, "_1": {"wer": 9.8441, "cer": 6.6526, "pitch_ser": 10.2764, "rhythm_ser": 6.2554, "seqer": 66.7539}}, "210000": {"_0": {"wer": 6.0943, "cer": 4.6482, "pitch_ser": 8.3849, "rhythm_ser": 4.0586, "seqer": 25.6504}, "_1": {"wer": 9.9171, "cer": 6.7607, "pitch_ser": 9.4542, "rhythm_ser": 6.7883, "seqer": 63.3508}}, "220000": {"_0": {"wer": 5.7868, "cer": 4.3883, "pitch_ser": 7.9285, "rhythm_ser": 3.763, "seqer": 25.026}, "_1": {"wer": 10.7043, "cer": 7.4398, "pitch_ser": 10.2379, "rhythm_ser": 7.4826, "seqer": 66.4921}}, "230000": {"_0": {"wer": 5.2454, "cer": 4.0341, "pitch_ser": 7.2945, "rhythm_ser": 3.4184, "seqer": 24.4017}, "_1": {"wer": 11.005, "cer": 7.8531, "pitch_ser": 10.5843, "rhythm_ser": 8.0531, "seqer": 65.9686}}, "240000": {"_0": {"wer": 5.7758, "cer": 4.4026, "pitch_ser": 8.0221, "rhythm_ser": 3.7351, "seqer": 24.0895}, "_1": {"wer": 9.2449, "cer": 6.3468, "pitch_ser": 9.3877, "rhythm_ser": 6.0232, "seqer": 64.3979}}, "250000": {"_0": {"wer": 5.5334, "cer": 4.2343, "pitch_ser": 7.3385, "rhythm_ser": 3.6785, "seqer": 25.2862}, "_1": {"wer": 9.1962, "cer": 6.4018, "pitch_ser": 9.4157, "rhythm_ser": 6.0586, "seqer": 65.1832}}},
    "2_more_layers": {"10000": {"_0": {"wer": 36.3198, "cer": 27.9934, "pitch_ser": 58.952, "rhythm_ser": 21.0339, "seqer": 85.4839}, "_1": {"wer": 128.3118, "cer": 104.3591, "pitch_ser": 147.5682, "rhythm_ser": 97.5036, "seqer": 99.7382}}, "20000": {"_0": {"wer": 14.2647, "cer": 10.768, "pitch_ser": 20.5278, "rhythm_ser": 9.2043, "seqer": 54.5265}, "_1": {"wer": 46.4986, "cer": 31.8497, "pitch_ser": 52.5752, "rhythm_ser": 29.2537, "seqer": 96.0733}}, "30000": {"_0": {"wer": 10.87, "cer": 7.7747, "pitch_ser": 14.5872, "rhythm_ser": 6.9153, "seqer": 46.462}, "_1": {"wer": 37.2582, "cer": 23.7976, "pitch_ser": 35.0035, "rhythm_ser": 24.1924, "seqer": 92.9319}}, "40000": {"_0": {"wer": 14.7132, "cer": 11.7724, "pitch_ser": 18.5648, "rhythm_ser": 11.2281, "seqer": 45.0052}, "_1": {"wer": 49.508, "cer": 38.076, "pitch_ser": 50.8362, "rhythm_ser": 37.6341, "seqer": 92.6702}}, "50000": {"_0": {"wer": 9.924, "cer": 7.9213, "pitch_ser": 13.9933, "rhythm_ser": 6.7844, "seqer": 37.3049}, "_1": {"wer": 38.9983, "cer": 29.5333, "pitch_ser": 42.2463, "rhythm_ser": 28.0929, "seqer": 87.1728}}, "60000": {"_0": {"wer": 7.9314, "cer": 5.8807, "pitch_ser": 11.0335, "rhythm_ser": 5.0452, "seqer": 33.4027}, "_1": {"wer": 23.0514, "cer": 15.1979, "pitch_ser": 26.1127, "rhythm_ser": 13.5611, "seqer": 81.4136}}, "70000": {"_0": {"wer": 7.1256, "cer": 5.3301, "pitch_ser": 10.5828, "rhythm_ser": 4.3416, "seqer": 33.1946}, "_1": {"wer": 16.7739, "cer": 10.3935, "pitch_ser": 18.8104, "rhythm_ser": 9.1852, "seqer": 76.178}}, "80000": {"_0": {"wer": 6.895, "cer": 5.1604, "pitch_ser": 9.9947, "rhythm_ser": 4.3602, "seqer": 32.3101}, "_1": {"wer": 20.7009, "cer": 14.2594, "pitch_ser": 23.0161, "rhythm_ser": 12.88, "seqer": 75.9162}}, "90000": {"_0": {"wer": 6.759, "cer": 5.0385, "pitch_ser": 9.8171, "rhythm_ser": 4.2656, "seqer": 31.6857}, "_1": {"wer": 20.9397, "cer": 15.3669, "pitch_ser": 21.4731, "rhythm_ser": 15.2615, "seqer": 79.0576}}, "100000": {"_0": {"wer": 7.6898, "cer": 5.9888, "pitch_ser": 11.1996, "rhythm_ser": 5.1102, "seqer": 30.7492}, "_1": {"wer": 25.1609, "cer": 19.8635, "pitch_ser": 26.2946, "rhythm_ser": 19.5931, "seqer": 71.466}}, "110000": {"_0": {"wer": 6.8122, "cer": 5.2696, "pitch_ser": 9.5898, "rhythm_ser": 4.5595, "seqer": 30.2289}, "_1": {"wer": 15.6882, "cer": 11.1289, "pitch_ser": 16.7075, "rhythm_ser": 10.3018, "seqer": 75.1309}}, "120000": {"_0": {"wer": 6.3021, "cer": 4.7299, "pitch_ser": 9.1182, "rhythm_ser": 3.9598, "seqer": 29.1883}, "_1": {"wer": 18.0873, "cer": 12.8258, "pitch_ser": 19.7726, "rhythm_ser": 12.0111, "seqer": 70.1571}}, "130000": {"_0": {"wer": 6.2683, "cer": 4.6961, "pitch_ser": 9.1525, "rhythm_ser": 3.8855, "seqer": 28.8762}}, "140000": {"_0": {"wer": 6.6441, "cer": 5.0295, "pitch_ser": 9.3416, "rhythm_ser": 4.3264, "seqer": 27.4714}, "_1": {"wer": 15.1664, "cer": 10.1675, "pitch_ser": 15.8922, "rhythm_ser": 9.7313, "seqer": 64.9215}}, "150000": {"_0": {"wer": 6.139, "cer": 4.4736, "pitch_ser": 8.8375, "rhythm_ser": 3.7537, "seqer": 27.4714}, "_1": {"wer": 12.4577, "cer": 7.9487, "pitch_ser": 12.1379, "rhythm_ser": 7.6727, "seqer": 67.0157}}, "160000": {"_1": {"wer": 7.7855, "cer": 4.9439, "pitch_ser": 8.289, "rhythm_ser": 4.5439, "seqer": 55.4974}}, "170000": {"_0": {"wer": 5.6052, "cer": 4.1545, "pitch_ser": 7.8025, "rhythm_ser": 3.5121, "seqer": 22.6847}, "_1": {"wer": 8.1747, "cer": 5.2766, "pitch_ser": 8.4745, "rhythm_ser": 4.8999, "seqer": 54.1885}}, "180000": {"_0": {"wer": 5.3653, "cer": 3.8993, "pitch_ser": 7.6535, "rhythm_ser": 3.2342, "seqer": 22.8928}}, "190000": {"_0": {"wer": 5.552, "cer": 4.1529, "pitch_ser": 7.9476, "rhythm_ser": 3.4344, "seqer": 23.7253}, "_1": {"wer": 9.9303, "cer": 7.0246, "pitch_ser": 10.6018, "rhythm_ser": 6.5627, "seqer": 54.9738}}, "200000": {"_0": {"wer": 5.5452, "cer": 4.206, "pitch_ser": 8.0374, "rhythm_ser": 3.4842, "seqer": 22.6327}, "_1": {"wer": 7.613, "cer": 4.8915, "pitch_ser": 8.0931, "rhythm_ser": 4.3582, "seqer": 53.1414}}, "210000": {"_0": {"wer": 5.4126, "cer": 4.0143, "pitch_ser": 7.6669, "rhythm_ser": 3.355, "seqer": 22.9969}, "_1": {"wer": 7.319, "cer": 4.6748, "pitch_ser": 7.6522, "rhythm_ser": 4.4268, "seqer": 51.8325}}, "220000": {"_0": {"wer": 5.0367, "cer": 3.6383, "pitch_ser": 7.0635, "rhythm_ser": 2.9648, "seqer": 22.7888}, "_1": {"wer": 7.9536, "cer": 5.2, "pitch_ser": 7.8901, "rhythm_ser": 5.2405, "seqer": 53.4031}}, "230000": {"_0": {"wer": 5.1668, "cer": 3.8531, "pitch_ser": 7.3556, "rhythm_ser": 3.2004, "seqer": 23.7253}, "_1": {"wer": 7.5445, "cer": 4.9053, "pitch_ser": 7.6837, "rhythm_ser": 4.6899, "seqer": 54.1885}}, "240000": {"_0": {"wer": 5.6322, "cer": 4.1881, "pitch_ser": 8.2627, "rhythm_ser": 3.4361, "seqer": 23.6212}, "_1": {"wer": 8.4002, "cer": 5.5962, "pitch_ser": 9.1987, "rhythm_ser": 5.0348, "seqer": 54.9738}}, "250000": {"_0": {"wer": 5.28, "cer": 3.9961, "pitch_ser": 7.39, "rhythm_ser": 3.377, "seqer": 22.6847}, "_1": {"wer": 8.084, "cer": 5.105, "pitch_ser": 8.5759, "rhythm_ser": 4.3449, "seqer": 52.6178}}},
    "3_small_net": {"10000": {"_0": {"wer": 49.4839, "cer": 37.7762, "pitch_ser": 77.7211, "rhythm_ser": 31.316, "seqer": 94.7451}, "_1": {"wer": 127.1996, "cer": 103.8404, "pitch_ser": 158.2855, "rhythm_ser": 96.6545, "seqer": 100.0}}, "20000": {"_0": {"wer": 18.559, "cer": 14.9099, "pitch_ser": 27.0108, "rhythm_ser": 13.0079, "seqer": 66.9095}, "_1": {"wer": 73.0724, "cer": 58.267, "pitch_ser": 86.8684, "rhythm_ser": 53.9856, "seqer": 98.9529}}, "30000": {"_0": {"wer": 10.8269, "cer": 8.2816, "pitch_ser": 15.2154, "rhythm_ser": 7.2236, "seqer": 48.5432}, "_1": {"wer": 44.0133, "cer": 33.4359, "pitch_ser": 48.4115, "rhythm_ser": 32.0022, "seqer": 95.288}}, "40000": {"_0": {"wer": 8.32, "cer": 6.2641, "pitch_ser": 11.6961, "rhythm_ser": 5.3831, "seqer": 42.6119}, "_1": {"wer": 27.403, "cer": 18.7128, "pitch_ser": 28.8943, "rhythm_ser": 18.1448, "seqer": 87.1728}}, "50000": {"_0": {"wer": 9.0895, "cer": 6.9248, "pitch_ser": 11.6311, "rhythm_ser": 6.4761, "seqer": 40.8429}, "_1": {"wer": 28.7452, "cer": 20.7313, "pitch_ser": 30.1085, "rhythm_ser": 20.5904, "seqer": 87.1728}}, "60000": {"_0": {"wer": 7.8605, "cer": 5.7858, "pitch_ser": 10.663, "rhythm_ser": 5.1829, "seqer": 38.1374}, "_1": {"wer": 27.5666, "cer": 20.0724, "pitch_ser": 28.5024, "rhythm_ser": 19.8076, "seqer": 85.8639}}, "70000": {"_0": {"wer": 7.2439, "cer": 5.3947, "pitch_ser": 10.1111, "rhythm_ser": 4.818, "seqer": 35.1717}, "_1": {"wer": 19.0603, "cer": 12.7309, "pitch_ser": 19.1952, "rhythm_ser": 13.0326, "seqer": 79.8429}}, "80000": {"_0": {"wer": 7.4812, "cer": 5.6566, "pitch_ser": 10.3537, "rhythm_ser": 4.916, "seqer": 34.6514}, "_1": {"wer": 24.7938, "cer": 18.9755, "pitch_ser": 28.5024, "rhythm_ser": 17.2957, "seqer": 80.8901}}, "90000": {"_0": {"wer": 8.6266, "cer": 6.6789, "pitch_ser": 10.7088, "rhythm_ser": 6.1686, "seqer": 36.3684}, "_1": {"wer": 17.8883, "cer": 12.2829, "pitch_ser": 18.4745, "rhythm_ser": 11.8032, "seqer": 78.7958}}, "100000": {"_0": {"wer": 7.1188, "cer": 5.6178, "pitch_ser": 10.0157, "rhythm_ser": 4.9252, "seqer": 32.8824}, "_1": {"wer": 16.0973, "cer": 11.1014, "pitch_ser": 16.599, "rhythm_ser": 10.9608, "seqer": 78.0105}}, "110000": {"_0": {"wer": 6.7413, "cer": 5.2088, "pitch_ser": 9.017, "rhythm_ser": 4.6372, "seqer": 31.2695}, "_1": {"wer": 13.9591, "cer": 9.734, "pitch_ser": 14.6396, "rhythm_ser": 9.0857, "seqer": 77.4869}}, "120000": {"_0": {"wer": 6.705, "cer": 5.3001, "pitch_ser": 9.3798, "rhythm_ser": 4.5899, "seqer": 32.102}, "_1": {"wer": 14.2753, "cer": 10.2081, "pitch_ser": 14.7691, "rhythm_ser": 9.7468, "seqer": 75.1309}}, "130000": {"_0": {"wer": 6.9491, "cer": 5.3353, "pitch_ser": 9.3951, "rhythm_ser": 4.7732, "seqer": 29.6046}, "_1": {"wer": 15.1509, "cer": 10.1911, "pitch_ser": 14.93, "rhythm_ser": 10.461, "seqer": 70.6806}}, "140000": {"_0": {"wer": 6.3063, "cer": 4.9921, "pitch_ser": 9.0704, "rhythm_ser": 4.3576, "seqer": 30.1249}, "_1": {"wer": 14.1404, "cer": 10.0365, "pitch_ser": 13.9328, "rhythm_ser": 10.3151, "seqer": 74.0838}}, "150000": {"_1": {"wer": 16.3339, "cer": 11.6784, "pitch_ser": 16.7495, "rhythm_ser": 11.5268, "seqer": 72.7749}}, "160000": {"_0": {"wer": 6.0149, "cer": 4.6221, "pitch_ser": 8.3658, "rhythm_ser": 4.0865, "seqer": 26.847}, "_1": {"wer": 9.8132, "cer": 6.4758, "pitch_ser": 10.0245, "rhythm_ser": 6.2244, "seqer": 64.6597}}, "170000": {"_0": {"wer": 5.6804, "cer": 4.4216, "pitch_ser": 8.15, "rhythm_ser": 3.7638, "seqer": 26.1707}, "_1": {"wer": 9.382, "cer": 6.39, "pitch_ser": 9.6396, "rhythm_ser": 6.0984, "seqer": 59.9476}}, "180000": {"_0": {"wer": 5.7032, "cer": 4.4444, "pitch_ser": 8.2436, "rhythm_ser": 3.8483, "seqer": 25.6504}, "_1": {"wer": 9.3068, "cer": 6.0239, "pitch_ser": 9.3562, "rhythm_ser": 5.9082, "seqer": 60.733}}, "190000": {"_0": {"wer": 5.6542, "cer": 4.3383, "pitch_ser": 8.2149, "rhythm_ser": 3.6354, "seqer": 25.4943}, "_1": {"wer": 9.8684, "cer": 6.5897, "pitch_ser": 10.042, "rhythm_ser": 6.3969, "seqer": 68.0628}}, "200000": {"_0": {"wer": 6.2336, "cer": 4.7981, "pitch_ser": 8.5415, "rhythm_ser": 4.2546, "seqer": 26.1707}, "_1": {"wer": 9.1498, "cer": 6.1182, "pitch_ser": 9.4857, "rhythm_ser": 5.8485, "seqer": 64.9215}}, "210000": {"_0": {"wer": 5.3856, "cer": 4.042, "pitch_ser": 7.5581, "rhythm_ser": 3.4479, "seqer": 24.8179}, "_1": {"wer": 8.88, "cer": 5.8458, "pitch_ser": 8.4395, "rhythm_ser": 6.0431, "seqer": 61.7801}}, "220000": {"_0": {"wer": 5.5883, "cer": 4.3306, "pitch_ser": 7.9686, "rhythm_ser": 3.6878, "seqer": 25.2341}, "_1": {"wer": 8.4887, "cer": 5.5648, "pitch_ser": 8.2925, "rhythm_ser": 5.6473, "seqer": 58.1152}}, "230000": {"_0": {"wer": 5.8096, "cer": 4.4901, "pitch_ser": 8.2398, "rhythm_ser": 3.8593, "seqer": 25.026}, "_1": {"wer": 8.7496, "cer": 6.0606, "pitch_ser": 9.1323, "rhythm_ser": 5.8154, "seqer": 59.9476}}, "240000": {"_0": {"wer": 5.5427, "cer": 4.3355, "pitch_ser": 8.1099, "rhythm_ser": 3.6118, "seqer": 23.8293}, "_1": {"wer": 7.9713, "cer": 5.4037, "pitch_ser": 8.0476, "rhythm_ser": 5.2383, "seqer": 60.9948}}, "250000": {"_0": {"wer": 5.318, "cer": 4.0858, "pitch_ser": 7.6115, "rhythm_ser": 3.4809, "seqer": 24.2976}, "_1": {"wer": 8.4732, "cer": 5.5838, "pitch_ser": 8.422, "rhythm_ser": 5.4395, "seqer": 60.4712}}},
    "4_big_net": {"10000": {"_0": {"wer": 22.7781, "cer": 18.994, "pitch_ser": 35.831, "rhythm_ser": 15.519, "seqer": 69.0427}, "_1": {"wer": 89.6517, "cer": 70.5551, "pitch_ser": 105.0665, "rhythm_ser": 65.6473, "seqer": 99.4764}}, "20000": {"_0": {"wer": 25.3121, "cer": 24.0864, "pitch_ser": 39.148, "rhythm_ser": 21.0812, "seqer": 53.538}, "_1": {"wer": 102.921, "cer": 93.8936, "pitch_ser": 128.9048, "rhythm_ser": 86.5252, "seqer": 98.1675}}, "30000": {"_0": {"wer": 9.4366, "cer": 7.2623, "pitch_ser": 13.2466, "rhythm_ser": 6.297, "seqer": 42.1436}, "_1": {"wer": 43.0669, "cer": 34.7425, "pitch_ser": 46.8789, "rhythm_ser": 33.9569, "seqer": 90.8377}}, "40000": {"_0": {"wer": 11.2814, "cer": 9.0358, "pitch_ser": 14.7418, "rhythm_ser": 8.494, "seqer": 41.3632}}, "50000": {"_0": {"wer": 8.4855, "cer": 6.6464, "pitch_ser": 12.1849, "rhythm_ser": 5.7724, "seqer": 37.7211}, "_1": {"wer": 36.2852, "cer": 28.9851, "pitch_ser": 37.8272, "rhythm_ser": 29.0193, "seqer": 89.7906}}, "60000": {"_0": {"wer": 7.3604, "cer": 5.7938, "pitch_ser": 10.1092, "rhythm_ser": 5.1111, "seqer": 36.2643}}, "70000": {"_0": {"wer": 7.9018, "cer": 6.0669, "pitch_ser": 9.6242, "rhythm_ser": 5.5545, "seqer": 32.3101}, "_1": {"wer": 22.8325, "cer": 17.5707, "pitch_ser": 24.6711, "rhythm_ser": 16.7474, "seqer": 78.7958}}, "80000": {"_0": {"wer": 6.6568, "cer": 5.0416, "pitch_ser": 9.4791, "rhythm_ser": 4.4531, "seqer": 28.9802}, "_1": {"wer": 16.869, "cer": 11.7642, "pitch_ser": 16.9769, "rhythm_ser": 11.77, "seqer": 71.466}}, "90000": {"_0": {"wer": 6.8148, "cer": 5.2883, "pitch_ser": 9.6127, "rhythm_ser": 4.5933, "seqer": 29.3965}, "_1": {"wer": 21.3776, "cer": 17.0225, "pitch_ser": 24.2232, "rhythm_ser": 15.6882, "seqer": 72.2513}}, "100000": {"_0": {"wer": 7.031, "cer": 5.4888, "pitch_ser": 9.5784, "rhythm_ser": 4.807, "seqer": 30.385}, "_1": {"wer": 19.6926, "cer": 15.3636, "pitch_ser": 20.7558, "rhythm_ser": 14.9475, "seqer": 72.5131}}, "110000": {"_0": {"wer": 6.7109, "cer": 5.2874, "pitch_ser": 9.4218, "rhythm_ser": 4.5958, "seqer": 27.6275}, "_1": {"wer": 16.7054, "cer": 12.9358, "pitch_ser": 18.8873, "rhythm_ser": 11.8629, "seqer": 67.2775}}, "120000": {"_0": {"wer": 6.6078, "cer": 5.0944, "pitch_ser": 9.3683, "rhythm_ser": 4.3627, "seqer": 28.0437}, "_1": {"wer": 12.471, "cer": 9.2159, "pitch_ser": 12.8586, "rhythm_ser": 9.1144, "seqer": 69.1099}}, "130000": {"_0": {"wer": 5.8138, "cer": 4.4103, "pitch_ser": 8.362, "rhythm_ser": 3.7554, "seqer": 26.4828}, "_1": {"wer": 19.4096, "cer": 14.9838, "pitch_ser": 19.3562, "rhythm_ser": 15.5644, "seqer": 67.801}}, "140000": {"_0": {"wer": 6.009, "cer": 4.6106, "pitch_ser": 8.3276, "rhythm_ser": 4.024, "seqer": 26.6389}, "_1": {"wer": 13.6142, "cer": 9.0077, "pitch_ser": 13.5724, "rhythm_ser": 9.2316, "seqer": 65.7068}}, "150000": {"_0": {"wer": 6.2438, "cer": 4.8595, "pitch_ser": 8.6637, "rhythm_ser": 4.1634, "seqer": 27.6795}, "_1": {"wer": 10.8038, "cer": 7.449, "pitch_ser": 10.7768, "rhythm_ser": 7.4605, "seqer": 64.9215}}, "160000": {"_0": {"wer": 5.1364, "cer": 3.8795, "pitch_ser": 7.2239, "rhythm_ser": 3.2807, "seqer": 22.8928}, "_1": {"wer": 10.4456, "cer": 7.8596, "pitch_ser": 9.937, "rhythm_ser": 7.7656, "seqer": 55.2356}}, "170000": {"_0": {"wer": 5.8915, "cer": 4.464, "pitch_ser": 7.896, "rhythm_ser": 3.9387, "seqer": 23.1009}}, "180000": {"_0": {"wer": 5.699, "cer": 4.3471, "pitch_ser": 7.6363, "rhythm_ser": 3.7621, "seqer": 21.9043}, "_1": {"wer": 10.6556, "cer": 7.6828, "pitch_ser": 10.6123, "rhythm_ser": 7.6374, "seqer": 55.7592}}},
}

# Spread to only indexes n*10_000 to match previous transformer results
results['0_default'] = {"0": {'_1': {'wer': 99.5}}, "10000": {'_1': {'wer': 61.6509}}, "20000": {'_1': {'wer': 30.834}}, "30000": {'_1': {'wer': 35.7844}}, "40000": {'_1': {'wer': 27.3081}}, "50000": {'_1': {'wer': 20.6856}}, "60000": {'_1': {'wer': 20.3951}}, "70000": {'_1': {'wer': 23.8809}}, "80000": {'_1': {'wer': 18.4397}}, "90000": {'_1': {'wer': 14.0643}}, "100000": {'_1': {'wer': 15.366}}, "110000": {'_1': {'wer': 12.5213}}, "120000": {'_1': {'wer': 13.5247}}, "130000": {'_1': {'wer': 13.0899}}, "140000": {'_1': {'wer': 13.6982}}, "150000": {'_1': {'wer': 11.1488}}, "160000": {'_1': {'wer': 11.8713}}, "170000": {'_1': {'wer': 13.2328}}, "180000": {'_1': {'wer': 11.7142}}, "190000": {'_1': {'wer': 11.161}}, "200000": {'_1': {'wer': 10.2894}}, "210000": {'_1': {'wer': 10.2874}}, "220000": {'_1': {'wer': 9.8996}}, "230000": {'_1': {'wer': 10.0731}}, "240000": {'_1': {'wer': 9.1913}}, "250000": {'_1': {'wer': 11.4937}},}  #"260000": {'_1': {'wer': 9.2382}}, "270000": {'_1': {'wer': 10.5895}}, "280000": {'_1': {'wer': 8.3258}}, "290000": {'_1': {'wer': 11.3018}}, "300000": {'_1': {'wer': 8.9668}}, "310000": {'_1': {'wer': 8.7688}}, "320000": {'_1': {'wer': 8.5055}}, "330000": {'_1': {'wer': 9.0035}}, "340000": {'_1': {'wer': 9.9302}}, "350000": {'_1': {'wer': 11.2508}}, "360000": {'_1': {'wer': 10.3037}}, "370000": {'_1': {'wer': 8.8831}}, "380000": {'_1': {'wer': 9.079}}, "390000": {'_1': {'wer': 9.0954}}, "400000": {'_1': {'wer': 8.8892}},}

rename_dict = {'0_default': '512_8h_4e_4d',
               '1_less_layers': '512_8h_2e_2d',
               '2_more_layers': '512_8h_6e_6d',
               '3_small_net': '256_4h_4e_4d',
               '4_big_net': '1024_16h_4e_4d'
               }

for old, new in rename_dict.items():
    if old in results:
        results[new] = results.pop(old)

for k, v in results.items():
    print(k)
    print(v)

results_only_sers = get_only_sers(results, '_1', limit_with_smallest=True)
plot_chart(results_only_sers, name='poly_sers_transformer_comparison_limit_with_smallest_1')
results_only_sers = get_only_sers(results, '_1')
plot_chart(results_only_sers, name='poly_sers_transformer_comparison_full_1')

# %% Get only SERS from dict of experiments

def get_only_sers(results, only_from_set=None, limit_with_smallest: bool = False):
    results_only_sers = {}

    for experiment, result in results.items():

        for iter_, data in result.items():
            if int(iter_) >= 0:
                for set_, errs in data.items():
                    if only_from_set and not only_from_set == set_:
                        continue

                    if set_ == '_0':
                        exp_name = f'{experiment} BMPD'
                    if set_ == '_1':
                        exp_name = f'{experiment} BMPD-Hard'
                    if exp_name in results_only_sers:
                        results_only_sers[exp_name][int(iter_)] = errs["wer"]
                    else:
                        results_only_sers[exp_name] = {int(iter_): errs["wer"]}

    if limit_with_smallest:
        print([max(experiment.keys()) for experiment in results_only_sers.values()])
        min_iter = min([max(experiment.keys()) for experiment in results_only_sers.values()])
        print(f'min_iter: {min_iter}')

        limited = {k: None for k in results_only_sers}

        for exp_name, experiment in results_only_sers.items():
            limited[exp_name] = {k: v for k, v in experiment.items() if k <= min_iter}

        results_only_sers = limited

    for experiment, result in results_only_sers.items():
        print(f"'{experiment}': {result}")
    return results_only_sers

# %% PLOT function
def formatter(val, _):
    if 1_000 < val < 1_000_000 and val % 1_000 == 0:
        return f'{int(val//1_000)} k'
    if val == 0:
        return '0'
    return str(int(val))

def plot_chart(results: dict, name = 'mono_sers', out_extension = '.pdf'):
    """Plot results to separate lines in chart."""
    fig, ax = plt.subplots(1,1)

    for (experiment, result) in results.items():
        result_index, result_value = get_average_result(result)
        print(f'{experiment}: result: {result_value:.2f}')

        plt.plot(list(result.keys()) + [result_index], list(result.values()) + [result_value],
                 '-x', markevery=np.array([-1]),
                 label=experiment)
    ax.xaxis.set_major_formatter(formatter)

    plt.xlabel('Počet trénovacích iterací.')
    plt.ylabel('Symbol Error Rate [%]')
    ax.set_yscale('log')
    plt.legend()
    plt.tight_layout()

    out = name + out_extension
    plt.savefig(out)
    plt.show()

def get_average_result(result, N=5) -> (int, float):
    """Get average from last N results and count the next key"""
    if N > len(result.values()):
        return 0, 0.0

    average = np.mean(list(result.values())[-N:])

    y_values = list(result.keys())
    next_iter = y_values[-1] + (y_values[-1] - y_values[-2])
    return next_iter, average
